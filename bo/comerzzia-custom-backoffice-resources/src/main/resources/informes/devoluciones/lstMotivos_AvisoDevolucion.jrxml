<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="lstMotivos_AvisoDevolucion" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" whenResourceMissingType="Key" uuid="52f39f11-5e05-4ab6-8c22-4e35db34e865">
	<property name="ireport.zoom" value="2.35794769100003"/>
	<property name="ireport.x" value="12"/>
	<property name="ireport.y" value="1"/>
	<parameter name="FECHA_DESDE" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="FECHA_HASTA" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="IDUSUARIO_DESDE" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="IDUSUARIO_HASTA" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="CODEMP" class="java.lang.String"/>
	<parameter name="DESEMP" class="java.lang.String"/>
	<parameter name="UID_ACTIVIDAD" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select distinct cab.cod_albaran_origen as factura_venta,
	cab.cod_albaran as factura_devolucion,
	cab.usuario,
	cast((select dcact.fecha from d_clie_albaranes_cab_tbl dcact where dcact.cod_albaran  = cab.cod_albaran_origen ) as date) as fecha_venta,
	 cast(cab.fecha as date) as fecha_devolucion,
 	medios.desmedpag_ven as medio_pag,
	if(datediff(maxDias.fecha_devolucion , maxDias.fecha_max_devolucion )<=0, '',datediff(maxDias.fecha_devolucion , maxDias.fecha_max_devolucion ) ) as diferencia
from d_clie_albaranes_cab_tbl cab
	inner join d_clie_albaranes_pag_tbl pag on (pag.uid_actividad = cab.uid_actividad and pag.id_clie_albaran = cab.id_clie_albaran )
	inner join d_medios_pago_ven_tbl medios	on (medios.uid_actividad = cab.uid_actividad and medios.id_medpag_ven = pag .id_medpag_ven )
	inner join x_max_dias_devolucion_tbl maxDias on (maxDias.uid_actividad = cab.uid_actividad and maxDias.id_albaran = cab.cod_albaran_origen )
	where
	  cab.cod_albaran_origen is not null
	  and cast(cab.fecha as date) >= $P{FECHA_DESDE}
	  and cast(cab.fecha as date) <= $P{FECHA_HASTA}
	  and cab.usuario >= $P{IDUSUARIO_DESDE}
	  and cab.usuario <= $P{IDUSUARIO_HASTA};]]>
	</queryString>
	<field name="factura_venta" class="java.lang.String"/>
	<field name="factura_devolucion" class="java.lang.String"/>
	<field name="usuario" class="java.lang.String"/>
	<field name="fecha_venta" class="java.sql.Date"/>
	<field name="fecha_devolucion" class="java.sql.Date"/>
	<field name="medio_pag" class="java.lang.String"/>
	<field name="diferencia" class="java.lang.String"/>
	<group name="Motivo">
		<groupExpression><![CDATA[]]></groupExpression>
		<groupHeader>
			<band height="15">
				<textField isBlankWhenNull="true">
					<reportElement uuid="846c9c94-df15-41a2-934e-909d14e15b23" x="-1" y="-1" width="99" height="16"/>
					<textElement>
						<font fontName="Tahoma" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{fecha_venta}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement uuid="8ceb0a24-6fdd-47cf-8888-5ae7f354ccc7" x="674" y="0" width="123" height="15"/>
					<textElement>
						<font fontName="Tahoma" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{medio_pag}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement uuid="79f6c639-0f2c-41ab-915e-e73dd6a7877b" x="100" y="0" width="97" height="15"/>
					<textElement>
						<font fontName="Tahoma" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{factura_venta}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement uuid="11f37483-2749-4447-a9d6-578ad13f8845" x="306" y="0" width="120" height="15"/>
					<textElement>
						<font fontName="Tahoma" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{factura_devolucion}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement uuid="3fb1117d-165e-4932-93a2-4c5f6564788d" x="197" y="0" width="97" height="15"/>
					<textElement>
						<font fontName="Tahoma" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{fecha_devolucion}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement uuid="af400ff2-773f-47b3-84bf-0222cb34d574" x="452" y="0" width="74" height="15"/>
					<textElement>
						<font fontName="Tahoma" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{usuario}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement uuid="44ab082e-31bc-485c-ae55-8fcd82479a71" x="546" y="0" width="112" height="15"/>
					<textElement>
						<font fontName="Tahoma" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{diferencia}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="17"/>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="141" splitType="Stretch">
			<textField pattern="dd/MM/yyyy">
				<reportElement uuid="f5db1f06-f21b-40a1-92c5-a169bfeee6df" x="0" y="0" width="100" height="14"/>
				<textElement>
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<textField pattern="HH.mm">
				<reportElement uuid="060b556d-d1ce-4805-91f6-2bc98f7146d0" x="0" y="14" width="100" height="14"/>
				<textElement>
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="55e3da7a-eed4-4dc7-b0a2-c64904838fa6" x="100" y="0" width="50" height="14"/>
				<textElement>
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{CODEMP}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="611b9321-64a3-4447-ba23-9bfd63b663b4" x="150" y="0" width="296" height="14"/>
				<textElement>
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{DESEMP}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="02a6eb33-44bc-4da8-9d1b-d51b5c1016ef" x="446" y="0" width="356" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font fontName="Tahoma" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{Evaluación de devoluciones}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="c50e976a-bd20-4b92-83b3-f3d7941d5d7b" x="446" y="20" width="356" height="34"/>
				<textElement textAlignment="Right">
					<font fontName="Tahoma" size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{Muestra información acerca de los días que han pasado desde que se hizo una venta hasta la devolución de algún artículo}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="75885874-cdaf-45cd-ab58-794cf9a894e4" x="-1" y="39" width="37" height="15"/>
				<textElement>
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{DESDE FECHA}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement uuid="9bb41293-a98f-427c-bc7f-1aaef7f73f38" x="36" y="39" width="51" height="15"/>
				<textElement>
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="94d8903a-cb76-44bc-b3a7-f392a95e93b6" x="87" y="39" width="37" height="15"/>
				<textElement>
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{HASTA}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement uuid="d5fa7c2d-c81f-4869-b188-89012da1f7c7" x="124" y="39" width="231" height="15"/>
				<textElement>
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_HASTA}]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<pageHeader>
		<band height="16" splitType="Stretch">
			<textField>
				<reportElement uuid="b17338e5-a94c-401a-a2e7-5b16c879ffc9" positionType="FixRelativeToBottom" x="100" y="1" width="97" height="15" backcolor="#FFFFFF"/>
				<textElement markup="none">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{ALBARÁN DE VENTA}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="b17338e5-a94c-401a-a2e7-5b16c879ffc9" positionType="FixRelativeToBottom" x="306" y="1" width="120" height="14" backcolor="#FFFFFF"/>
				<textElement markup="none">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{ALBARÁN DE DEVOLUCIÓN}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement uuid="f5b8ccbb-67f9-4349-a411-d1318434bae3" x="0" y="15" width="802" height="1"/>
			</line>
			<textField>
				<reportElement uuid="47838ebc-77dc-4ae2-ba04-a9f966dfb860" positionType="FixRelativeToBottom" x="452" y="1" width="74" height="14" backcolor="#FFFFFF"/>
				<textElement markup="none">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{SUPERVISOR}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="b17338e5-a94c-401a-a2e7-5b16c879ffc9" positionType="FixRelativeToBottom" x="1" y="1" width="97" height="15" backcolor="#FFFFFF"/>
				<textElement markup="none">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{FECHA DE VENTA}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="b17338e5-a94c-401a-a2e7-5b16c879ffc9" positionType="FixRelativeToBottom" x="197" y="1" width="97" height="14" backcolor="#FFFFFF"/>
				<textElement markup="none">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{FECHA DE DEVOLUCION}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="47838ebc-77dc-4ae2-ba04-a9f966dfb860" positionType="FixRelativeToBottom" x="546" y="1" width="112" height="14" backcolor="#FFFFFF"/>
				<textElement markup="none">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{DÍAS SOBRE PLAZO}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="47838ebc-77dc-4ae2-ba04-a9f966dfb860" positionType="FixRelativeToBottom" x="674" y="1" width="128" height="14" backcolor="#FFFFFF"/>
				<textElement markup="none">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{FORMA DE PAGO}]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<pageFooter>
		<band height="26" splitType="Stretch">
			<textField pattern="" isBlankWhenNull="false">
				<reportElement uuid="5e22237c-eb2d-49fc-bd90-49c2778e287a" key="textField" x="546" y="0" width="256" height="12" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right">
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{Página} +" "+ $V{PAGE_NUMBER} +" "+ $R{de} + " " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
</jasperReport>
