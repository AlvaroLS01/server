<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="lstMotivos_MediosPago" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" whenResourceMissingType="Key" uuid="52f39f11-5e05-4ab6-8c22-4e35db34e865">
	<property name="ireport.zoom" value="1.6105100000000259"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="FECHA_DESDE" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="FECHA_HASTA" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="IDUSUARIO_DESDE" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="IDUSUARIO_HASTA" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="CODEMP" class="java.lang.String"/>
	<parameter name="DESEMP" class="java.lang.String"/>
	<parameter name="CODART_DESDE" class="java.lang.String"/>
	<parameter name="CODART_HASTA" class="java.lang.String"/>
	<parameter name="CODFAM_DESDE" class="java.lang.String"/>
	<parameter name="CODFAM_HASTA" class="java.lang.String"/>
	<parameter name="IDTICKET_DESDE" class="java.lang.String"/>
	<parameter name="IDTICKET_HASTA" class="java.lang.String"/>
	<parameter name="CODPAGO_DESDE" class="java.lang.String"/>
	<parameter name="CODPAGO_HASTA" class="java.lang.String"/>
	<parameter name="UID_ACTIVIDAD" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select distinct cab.codcaja, cab.cod_albaran_origen as factura_venta, cab.cod_albaran as factura_devolucion, cab.total,
		(select med.desmedpag_ven
			from d_clie_albaranes_cab_tbl dcact
			inner join d_clie_albaranes_pag_tbl pago on (pago.uid_actividad = dcact.uid_actividad and pago.id_clie_albaran = dcact.id_clie_albaran )
			inner join d_medios_pago_ven_tbl med on (med.uid_actividad = dcact.uid_actividad and med.id_medpag_ven = pago.id_medpag_ven )
			where dcact.cod_albaran  = cab.cod_albaran_origen) as medio_pago_venta, medios.desmedpag_ven as medio_pago_dev
	from d_clie_albaranes_cab_tbl cab
		inner join d_clie_albaranes_det_tbl det on (cab.uid_actividad = det.uid_actividad and cab.id_clie_albaran = det.id_clie_albaran )
		inner join  d_articulos_tbl art ON (det.uid_actividad = art.uid_actividad AND det.codart = art.codart)
		left outer join d_familias_tbl fam ON (cab.uid_actividad = fam.uid_actividad AND art.codfam = fam.codfam)
		inner join d_clie_albaranes_pag_tbl pag on (pag.uid_actividad = cab.uid_actividad and pag.id_clie_albaran = cab.id_clie_albaran )
		inner join d_medios_pago_ven_tbl medios	on (medios.uid_actividad = cab.uid_actividad and medios.id_medpag_ven = pag.id_medpag_ven )
	where
	  CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}
	  and cab.cod_albaran_origen is not null
	  and cast(cab.fecha as date) >= $P{FECHA_DESDE}
	  and cast(cab.fecha as date) <= $P{FECHA_HASTA}
	  and det.codart >= $P{CODART_DESDE}
	  and det.codart <= $P{CODART_HASTA}
	  and  ((fam.codfam >= $P{CODFAM_DESDE} AND fam.codfam <= $P{CODFAM_HASTA})
		or ('0' = $P{CODFAM_DESDE} and 'ZZZZ' = $P{CODFAM_HASTA} and fam.codfam is null))
	  and cab.usuario >= $P{IDUSUARIO_DESDE}
	  and cab.usuario <= $P{IDUSUARIO_HASTA}
	  and cab.cod_albaran >= $P{IDTICKET_DESDE}
	  and cab.cod_albaran <= $P{IDTICKET_HASTA}
	  and medios.codmedpag >= $P{CODPAGO_DESDE}
	  and medios.codmedpag <= $P{CODPAGO_HASTA}
;]]>
	</queryString>
	<field name="codcaja" class="java.lang.String"/>
	<field name="factura_venta" class="java.lang.String"/>
	<field name="factura_devolucion" class="java.lang.String"/>
	<field name="total" class="java.math.BigDecimal"/>
	<field name="medio_pago_venta" class="java.lang.String"/>
	<field name="medio_pago_dev" class="java.lang.String"/>
	<group name="Medios Pago">
		<groupExpression><![CDATA[$F{factura_devolucion}]]></groupExpression>
		<groupHeader>
			<band height="50">
				<textField isBlankWhenNull="true">
					<reportElement uuid="e714d0ee-71ff-47ef-b6e5-86249527a799" x="0" y="0" width="37" height="15"/>
					<textElement>
						<font fontName="Tahoma" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{codcaja}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement uuid="956ec016-9579-45e3-95c1-a42031e9dfa3" x="57" y="0" width="97" height="14"/>
					<textElement>
						<font fontName="Tahoma" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{factura_venta}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement uuid="a251c9dd-caee-4642-8669-31054dea8d1e" x="171" y="0" width="124" height="14"/>
					<textElement>
						<font fontName="Tahoma" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{factura_devolucion}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement uuid="69bb6d81-9b62-49e4-8f9c-911a3b299aa0" x="310" y="0" width="96" height="14"/>
					<textElement>
						<font fontName="Tahoma" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{medio_pago_venta}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement uuid="599df847-f0e2-4f50-8806-d742b3c9ec42" x="428" y="0" width="143" height="14"/>
					<textElement>
						<font fontName="Tahoma" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{medio_pago_dev}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement uuid="ceee052c-fee3-45a7-aa3d-f848db7f2fb1" x="595" y="0" width="112" height="14"/>
					<textElement>
						<font fontName="Tahoma" size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{total}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="141" splitType="Stretch">
			<textField pattern="dd/MM/yyyy">
				<reportElement uuid="f5db1f06-f21b-40a1-92c5-a169bfeee6df" x="0" y="0" width="100" height="14"/>
				<textElement>
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<textField pattern="HH.mm">
				<reportElement uuid="060b556d-d1ce-4805-91f6-2bc98f7146d0" x="0" y="14" width="100" height="14"/>
				<textElement>
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="55e3da7a-eed4-4dc7-b0a2-c64904838fa6" x="100" y="0" width="50" height="14"/>
				<textElement>
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{CODEMP}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="611b9321-64a3-4447-ba23-9bfd63b663b4" x="150" y="0" width="296" height="14"/>
				<textElement>
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{DESEMP}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="02a6eb33-44bc-4da8-9d1b-d51b5c1016ef" x="446" y="0" width="356" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font fontName="Tahoma" size="11" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{Evaluación de medios de pago}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="c50e976a-bd20-4b92-83b3-f3d7941d5d7b" x="446" y="20" width="356" height="34"/>
				<textElement textAlignment="Right">
					<font fontName="Tahoma" size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{Muestra información acerca de los distintos medios de pago usados en las diversas devoluciones}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="75885874-cdaf-45cd-ab58-794cf9a894e4" x="0" y="62" width="37" height="15"/>
				<textElement>
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{DESDE FECHA}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement uuid="9bb41293-a98f-427c-bc7f-1aaef7f73f38" x="37" y="62" width="51" height="15"/>
				<textElement>
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="94d8903a-cb76-44bc-b3a7-f392a95e93b6" x="88" y="62" width="37" height="15"/>
				<textElement>
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{HASTA}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement uuid="d5fa7c2d-c81f-4869-b188-89012da1f7c7" x="125" y="62" width="231" height="15"/>
				<textElement>
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_HASTA}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="false">
				<reportElement uuid="b5b49646-b004-4659-9c7c-d6cbbb75a147" x="0" y="77" width="446" height="15"/>
				<textElement>
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{DESDE FAMILIA} + " " + $P{CODFAM_DESDE} + " " + $R{HASTA} + " " + $P{CODFAM_HASTA}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="b5dcee44-b8a3-4454-addb-c6b7325d864a" x="0" y="47" width="446" height="15"/>
				<textElement>
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{DESDE ARTÍCULO} + " " + $P{CODART_DESDE} + " " + $R{HASTA} + " " + $P{CODART_HASTA}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="b5dcee44-b8a3-4454-addb-c6b7325d864a" x="0" y="92" width="446" height="15"/>
				<textElement>
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{DESDE MEDIO DE  PAGO} + " " + $P{CODPAGO_DESDE} + " " + $R{HASTA} + " " + $P{CODPAGO_HASTA}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="b5dcee44-b8a3-4454-addb-c6b7325d864a" x="0" y="107" width="446" height="15"/>
				<textElement>
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{DESDE SUPERVISOR} + " " + $P{IDUSUARIO_DESDE} + " " + $R{HASTA} + " " + $P{IDUSUARIO_HASTA}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="b5dcee44-b8a3-4454-addb-c6b7325d864a" x="0" y="32" width="446" height="15"/>
				<textElement>
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{DESDE TICKET} + " " + $P{IDTICKET_DESDE} + " " + $R{HASTA} + " " + $P{IDTICKET_HASTA}]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<pageHeader>
		<band height="17" splitType="Stretch">
			<textField>
				<reportElement uuid="b17338e5-a94c-401a-a2e7-5b16c879ffc9" positionType="FixRelativeToBottom" x="171" y="0" width="124" height="15" backcolor="#FFFFFF"/>
				<textElement markup="none">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{ALBARÁN DE DEVOLUCIÓN}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement uuid="f5b8ccbb-67f9-4349-a411-d1318434bae3" x="0" y="15" width="802" height="1"/>
			</line>
			<textField>
				<reportElement uuid="47838ebc-77dc-4ae2-ba04-a9f966dfb860" positionType="FixRelativeToBottom" x="428" y="0" width="143" height="15" backcolor="#FFFFFF"/>
				<textElement markup="none">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{FORMA PAGO DEVOLUCION}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="b17338e5-a94c-401a-a2e7-5b16c879ffc9" positionType="FixRelativeToBottom" x="311" y="0" width="97" height="15" backcolor="#FFFFFF"/>
				<textElement markup="none">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{FORMA PAGO VENTA}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="47838ebc-77dc-4ae2-ba04-a9f966dfb860" positionType="FixRelativeToBottom" x="595" y="0" width="112" height="15" backcolor="#FFFFFF"/>
				<textElement markup="none">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{IMPORTE}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="47838ebc-77dc-4ae2-ba04-a9f966dfb860" positionType="FixRelativeToBottom" x="0" y="0" width="37" height="15" backcolor="#FFFFFF"/>
				<textElement markup="none">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{CAJA}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="b17338e5-a94c-401a-a2e7-5b16c879ffc9" positionType="FixRelativeToBottom" x="57" y="0" width="97" height="15" backcolor="#FFFFFF"/>
				<textElement markup="none">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{ALBARÁN DE VENTA}]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<pageFooter>
		<band height="26" splitType="Stretch">
			<textField pattern="" isBlankWhenNull="false">
				<reportElement uuid="5e22237c-eb2d-49fc-bd90-49c2778e287a" key="textField" x="546" y="0" width="256" height="12" forecolor="#000000" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right">
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{Página} +" "+ $V{PAGE_NUMBER} +" "+ $R{de} + " " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
</jasperReport>
