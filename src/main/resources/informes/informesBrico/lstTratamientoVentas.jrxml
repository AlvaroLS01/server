<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="lstTratamientoVentas" pageWidth="2005" pageHeight="988" orientation="Landscape" whenNoDataType="AllSectionsNoDetail" columnWidth="1977" leftMargin="14" rightMargin="14" topMargin="14" bottomMargin="14" whenResourceMissingType="Key" uuid="c3c4659a-89b3-4ec7-b737-477cefa21e80">
	<property name="ireport.zoom" value="1.4641000000000166"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="FECHA_DESDE" class="java.util.Date"/>
	<parameter name="FECHA_HASTA" class="java.util.Date"/>
	<parameter name="CODALM_DESDE" class="java.lang.String"/>
	<parameter name="CODALM_HASTA" class="java.lang.String"/>
	<parameter name="UID_ACTIVIDAD" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT A.FILA, A.TOTAL1, A.TOTAL2, A.TOTAL3, A.TOTAL4, A.TOTAL5, A.TOTAL6, A.TOTAL7, A.TOTAL8, A.TOTAL9, A.TOTAL10, A.TOTAL11, A.TOTAL12, A.TOTAL13, A.TOTAL14, A.TOTAL14, A.TOTAL15, A.TOTAL16, A.TOTAL17, A.TOTAL18, A.TOTAL19, A.TOTAL20, A.TOTAL21, A.TOTAL22, A.TOTAL23, A.TOTAL24, A.TOTAL25, A.TOTAL26, A.TOTAL27, A.TOTAL28, A.TOTAL29, A.TOTAL30, A.TOTAL31, (A.TOTAL1 + A.TOTAL2 + A.TOTAL3 + A.TOTAL4 + A.TOTAL5 + A.TOTAL6 + A.TOTAL7 + A.TOTAL8 + A.TOTAL9 + A.TOTAL10 + A.TOTAL11 + A.TOTAL12 + A.TOTAL13 + A.TOTAL14 + A.TOTAL14 + A.TOTAL15 + A.TOTAL16 + A.TOTAL17 + A.TOTAL18 + A.TOTAL19 + A.TOTAL20 + A.TOTAL21 + A.TOTAL22 + A.TOTAL23 + A.TOTAL24 + A.TOTAL25 + A.TOTAL26 + A.TOTAL27 + A.TOTAL28 + A.TOTAL29 + A.TOTAL30 + A.TOTAL31) AS TOTAL
FROM(
SELECT
'KPI' AS FILA,
SUM(CASE
     WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 01 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 02 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 03 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 04 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 05 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 06 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 07 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 08 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 09 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 10 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 11 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 12 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 13 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 14 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 15 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 16 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 17 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 18 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 19 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 20 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 21 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 22 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 23 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 24 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 25 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 26 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 27 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 28 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 29 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 30 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = 31 THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1*ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
) AS TOTAL31
FROM
	D_CLIE_ALBARANES_CAB_TBL CAB LEFT join
	D_ALMACENES_CONCEPTOS_TBL CONC ON (CAB.UID_ACTIVIDAD = CONC.UID_ACTIVIDAD AND
									   CAB.CODAPLICACION = CONC.CODAPLICACION and
									   CAB.CODCONALM = CONC.CODCONALM) LEFT JOIN
	D_TIPOS_DOCUMENTOS_TBL DOC ON (DOC.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
								   DOC.ID_TIPO_DOCUMENTO = CAB.ID_TIPO_DOCUMENTO) LEFT JOIN
	D_TIPOS_DOCUMENTOS_PROP_TBL DOC_ESTANDAR ON (DOC_ESTANDAR.UID_ACTIVIDAD = DOC.UID_ACTIVIDAD AND
												 DOC_ESTANDAR.ID_TIPO_DOCUMENTO = DOC.ID_TIPO_DOCUMENTO and
												 DOC_ESTANDAR.PROPIEDAD = 'TIPO_DOCUMENTO_ESTANDAR')
WHERE
CAB.FECHA >= $P{FECHA_DESDE} AND
CAB.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
'CIFRA VENTA' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
	DET.ID_TIPO_DOCUMENTO IS NOT NULL AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

(SELECT 'DIFERENCIA' AS FILA,
       (SUM(SUBTOTALA_1) - SUM(SUBTOTALB_1)) AS TOTAL1,
       (SUM(SUBTOTALA_2) - SUM(SUBTOTALB_2)) AS TOTAL2,
       (SUM(SUBTOTALA_3) - SUM(SUBTOTALB_3)) AS TOTAL3,
       (SUM(SUBTOTALA_4) - SUM(SUBTOTALB_4)) AS TOTAL4,
       (SUM(SUBTOTALA_5) - SUM(SUBTOTALB_5)) AS TOTAL5,
       (SUM(SUBTOTALA_6) - SUM(SUBTOTALB_6)) AS TOTAL6,
       (SUM(SUBTOTALA_7) - SUM(SUBTOTALB_7)) AS TOTAL7,
       (SUM(SUBTOTALA_8) - SUM(SUBTOTALB_8)) AS TOTAL8,
       (SUM(SUBTOTALA_9) - SUM(SUBTOTALB_9)) AS TOTAL9,
       (SUM(SUBTOTALA_10) - SUM(SUBTOTALB_10)) AS TOTAL10,
       (SUM(SUBTOTALA_11) - SUM(SUBTOTALB_11)) AS TOTAL11,
       (SUM(SUBTOTALA_12) - SUM(SUBTOTALB_12)) AS TOTAL12,
       (SUM(SUBTOTALA_13) - SUM(SUBTOTALB_13)) AS TOTAL13,
       (SUM(SUBTOTALA_14) - SUM(SUBTOTALB_14)) AS TOTAL14,
       (SUM(SUBTOTALA_15) - SUM(SUBTOTALB_15)) AS TOTAL15,
       (SUM(SUBTOTALA_16) - SUM(SUBTOTALB_16)) AS TOTAL16,
       (SUM(SUBTOTALA_17) - SUM(SUBTOTALB_17)) AS TOTAL17,
       (SUM(SUBTOTALA_18) - SUM(SUBTOTALB_18)) AS TOTAL18,
       (SUM(SUBTOTALA_19) - SUM(SUBTOTALB_19)) AS TOTAL19,
       (SUM(SUBTOTALA_20) - SUM(SUBTOTALB_20)) AS TOTAL20,
       (SUM(SUBTOTALA_21) - SUM(SUBTOTALB_21)) AS TOTAL21,
       (SUM(SUBTOTALA_22) - SUM(SUBTOTALB_22)) AS TOTAL22,
       (SUM(SUBTOTALA_23) - SUM(SUBTOTALB_23)) AS TOTAL23,
       (SUM(SUBTOTALA_24) - SUM(SUBTOTALB_24)) AS TOTAL24,
       (SUM(SUBTOTALA_25) - SUM(SUBTOTALB_25)) AS TOTAL25,
       (SUM(SUBTOTALA_26) - SUM(SUBTOTALB_26)) AS TOTAL26,
       (SUM(SUBTOTALA_27) - SUM(SUBTOTALB_27)) AS TOTAL27,
       (SUM(SUBTOTALA_28) - SUM(SUBTOTALB_28)) AS TOTAL28,
       (SUM(SUBTOTALA_29) - SUM(SUBTOTALB_29)) AS TOTAL29,
       (SUM(SUBTOTALA_30) - SUM(SUBTOTALB_30)) AS TOTAL30,
       (SUM(SUBTOTALA_31) - SUM(SUBTOTALB_31)) AS TOTAL31
FROM (
    SELECT
        SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '01' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
        ) AS SUBTOTALA_1,
        0 AS SUBTOTALB_1,
        SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '02' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_2,
        0 AS SUBTOTALB_2,
 SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '03' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_3,
        0 AS SUBTOTALB_3,
         SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '04' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_4,
        0 AS SUBTOTALB_4,
         SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '05' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_5,
        0 AS SUBTOTALB_5,
         SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '06' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_6,
        0 AS SUBTOTALB_6,
         SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '07' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_7,
        0 AS SUBTOTALB_7,
        SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '08' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_8,
        0 AS SUBTOTALB_8,
         SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '09' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_9,
        0 AS SUBTOTALB_9,
         SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '10' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_10,
        0 AS SUBTOTALB_10,
         SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '11' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_11,
        0 AS SUBTOTALB_11,
         SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '12' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_12,
        0 AS SUBTOTALB_12,
         SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '13' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_13,
        0 AS SUBTOTALB_13,
         SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '14' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_14,
        0 AS SUBTOTALB_14,
         SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '15' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_15,
        0 AS SUBTOTALB_15,
         SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '16' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_16,
        0 AS SUBTOTALB_16,
         SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '17' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_17,
        0 AS SUBTOTALB_17,
        SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '18' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_18,
        0 AS SUBTOTALB_18,
         SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '19' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_19,
        0 AS SUBTOTALB_19,
         SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '20' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_20,
        0 AS SUBTOTALB_20,
        SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '21' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
        ) AS SUBTOTALA_21,
        0 AS SUBTOTALB_21,
        SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '22' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_22,
        0 AS SUBTOTALB_22,
 SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '23' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_23,
        0 AS SUBTOTALB_23,
         SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '24' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_24,
        0 AS SUBTOTALB_24,
         SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '25' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_25,
        0 AS SUBTOTALB_25,
         SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '26' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_26,
        0 AS SUBTOTALB_26,
         SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '27' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_27,
        0 AS SUBTOTALB_27,
        SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '28' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_28,
        0 AS SUBTOTALB_28,
         SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '29' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_29,
        0 AS SUBTOTALB_29,
         SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '30' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_30,
        0 AS SUBTOTALB_30,
         SUM(CASE
  WHEN LPAD(DAYOFMONTH(CAB.FECHA), 2, '0') = '31' THEN (CASE WHEN (DOC.CODTIPODOCUMENTO = 'NC' OR DOC_ESTANDAR.VALOR = 'NC') AND CONC.SIGNO IS NOT NULL THEN -1 * ABS(CAB.TOTAL) ELSE CAB.TOTAL END) ELSE 0 END
		) AS SUBTOTALA_31,
        0 AS SUBTOTALB_31
    FROM
        D_CLIE_ALBARANES_CAB_TBL CAB
    LEFT JOIN
        D_ALMACENES_CONCEPTOS_TBL CONC ON (CAB.UID_ACTIVIDAD = CONC.UID_ACTIVIDAD AND
                                            CAB.CODAPLICACION = CONC.CODAPLICACION AND
                                            CAB.CODCONALM = CONC.CODCONALM)
    LEFT JOIN
        D_TIPOS_DOCUMENTOS_TBL DOC ON (DOC.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
                                       DOC.ID_TIPO_DOCUMENTO = CAB.ID_TIPO_DOCUMENTO)
    LEFT JOIN
        D_TIPOS_DOCUMENTOS_PROP_TBL DOC_ESTANDAR ON (DOC_ESTANDAR.UID_ACTIVIDAD = DOC.UID_ACTIVIDAD AND
                                                     DOC_ESTANDAR.ID_TIPO_DOCUMENTO = DOC.ID_TIPO_DOCUMENTO AND
                                                     DOC_ESTANDAR.PROPIEDAD = 'TIPO_DOCUMENTO_ESTANDAR')
    WHERE
CAB.FECHA >= $P{FECHA_DESDE} AND
CAB.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

    UNION ALL

    SELECT
        0 AS SUBTOTALA_1,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '01' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_1,
        0 AS SUBTOTALA_2,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '02' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_2,
        0 AS SUBTOTALA_3,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '03' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_3,
        0 AS SUBTOTALA_4,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '04' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_4,
        0 AS SUBTOTALA_5,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '05' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_5,
        0 AS SUBTOTALA_6,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '06' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_6,
        0 AS SUBTOTALA_7,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '07' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_7,
        0 AS SUBTOTALA_8,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '08' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_8,
        0 AS SUBTOTALA_9,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '09' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_9,
        0 AS SUBTOTALA_10,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '10' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_10,
        0 AS SUBTOTALA_11,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '11' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_11,
        0 AS SUBTOTALA_12,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '12' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_12,
        0 AS SUBTOTALA_13,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '13' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_13,
        0 AS SUBTOTALA_14,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '14' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_14,
        0 AS SUBTOTALA_15,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '15' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_15,
        0 AS SUBTOTALA_16,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '16' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_16,
        0 AS SUBTOTALA_17,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '17' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_7,
        0 AS SUBTOTALA_18,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '18' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_18,
        0 AS SUBTOTALA_19,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '19' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_19,
        0 AS SUBTOTALA_20,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '20' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_20,
        0 AS SUBTOTALA_21,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '21' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_21,
        0 AS SUBTOTALA_22,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '22' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_22,
        0 AS SUBTOTALA_23,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '23' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_23,
        0 AS SUBTOTALA_24,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '24' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_24,
        0 AS SUBTOTALA_25,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '25' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_25,
        0 AS SUBTOTALA_26,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '26' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_26,
        0 AS SUBTOTALA_27,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '27' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_27,
        0 AS SUBTOTALA_28,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '28' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_28,
        0 AS SUBTOTALA_29,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '29' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_29,
        0 AS SUBTOTALA_30,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '30' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_30,
        0 AS SUBTOTALA_31,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '31' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_31
    FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
    WHERE DET.ID_TIPO_DOCUMENTO IS NOT NULL AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}) AS DIFERENCIA)

UNION ALL

SELECT
'S.I. COFRE' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
CAB.CODCAJA =80 and DET.CODCONCEPTO_MOV = 00 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
'S.F. COFRE 26010800' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
CAB.CODCAJA =80 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
'COMPRA MONEDA' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
DET.CODCONCEPTO_MOV = 82 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}


UNION ALL

(SELECT 'S.I. COFRE RETIRADA' AS FILA,
       (SUM(SUBTOTALA_1) - ABS(SUM(SUBTOTALB_1))) AS TOTAL1,
       (SUM(SUBTOTALA_2) - ABS(SUM(SUBTOTALB_2))) AS TOTAL2,
       (SUM(SUBTOTALA_3) - ABS(SUM(SUBTOTALB_3))) AS TOTAL3,
       (SUM(SUBTOTALA_4) - ABS(SUM(SUBTOTALB_4))) AS TOTAL4,
       (SUM(SUBTOTALA_5) - ABS(SUM(SUBTOTALB_5))) AS TOTAL5,
       (SUM(SUBTOTALA_6) - ABS(SUM(SUBTOTALB_6))) AS TOTAL6,
       (SUM(SUBTOTALA_7) - ABS(SUM(SUBTOTALB_7))) AS TOTAL7,
       (SUM(SUBTOTALA_8) - ABS(SUM(SUBTOTALB_8))) AS TOTAL8,
       (SUM(SUBTOTALA_9) - ABS(SUM(SUBTOTALB_9))) AS TOTAL9,
       (SUM(SUBTOTALA_10) - ABS(SUM(SUBTOTALB_10))) AS TOTAL10,
       (SUM(SUBTOTALA_11) - ABS(SUM(SUBTOTALB_11))) AS TOTAL11,
       (SUM(SUBTOTALA_12) - ABS(SUM(SUBTOTALB_12))) AS TOTAL12,
       (SUM(SUBTOTALA_13) - ABS(SUM(SUBTOTALB_13))) AS TOTAL13,
       (SUM(SUBTOTALA_14) - ABS(SUM(SUBTOTALB_14))) AS TOTAL14,
       (SUM(SUBTOTALA_15) - ABS(SUM(SUBTOTALB_15))) AS TOTAL15,
       (SUM(SUBTOTALA_16) - ABS(SUM(SUBTOTALB_16))) AS TOTAL16,
       (SUM(SUBTOTALA_17) - ABS(SUM(SUBTOTALB_17))) AS TOTAL17,
       (SUM(SUBTOTALA_18) - ABS(SUM(SUBTOTALB_18))) AS TOTAL18,
       (SUM(SUBTOTALA_19) - ABS(SUM(SUBTOTALB_19))) AS TOTAL19,
       (SUM(SUBTOTALA_20) - ABS(SUM(SUBTOTALB_20))) AS TOTAL20,
       (SUM(SUBTOTALA_21) - ABS(SUM(SUBTOTALB_21))) AS TOTAL21,
       (SUM(SUBTOTALA_22) - ABS(SUM(SUBTOTALB_22))) AS TOTAL22,
       (SUM(SUBTOTALA_23) - ABS(SUM(SUBTOTALB_23))) AS TOTAL23,
       (SUM(SUBTOTALA_24) - ABS(SUM(SUBTOTALB_24))) AS TOTAL24,
       (SUM(SUBTOTALA_25) - ABS(SUM(SUBTOTALB_25))) AS TOTAL25,
       (SUM(SUBTOTALA_26) - ABS(SUM(SUBTOTALB_26))) AS TOTAL26,
       (SUM(SUBTOTALA_27) - ABS(SUM(SUBTOTALB_27))) AS TOTAL27,
       (SUM(SUBTOTALA_28) - ABS(SUM(SUBTOTALB_28))) AS TOTAL28,
       (SUM(SUBTOTALA_29) - ABS(SUM(SUBTOTALB_29))) AS TOTAL29,
       (SUM(SUBTOTALA_30) - ABS(SUM(SUBTOTALB_30))) AS TOTAL30,
       (SUM(SUBTOTALA_31) - ABS(SUM(SUBTOTALB_31))) AS TOTAL31
FROM (
    SELECT
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS SUBTOTALA_1,
        0 AS SUBTOTALB_1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_2,
        0 AS SUBTOTALB_2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_3,
        0 AS SUBTOTALB_3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_4,
        0 AS SUBTOTALB_4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_5,
        0 AS SUBTOTALB_5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_6,
        0 AS SUBTOTALB_6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_7,
        0 AS SUBTOTALB_7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_8,
        0 AS SUBTOTALB_8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_9,
        0 AS SUBTOTALB_9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_10,
        0 AS SUBTOTALB_10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_11,
        0 AS SUBTOTALB_11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_12,
        0 AS SUBTOTALB_12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_13,
        0 AS SUBTOTALB_13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_14,
        0 AS SUBTOTALB_14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_15,
        0 AS SUBTOTALB_15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_16,
        0 AS SUBTOTALB_16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_17,
        0 AS SUBTOTALB_17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_18,
        0 AS SUBTOTALB_18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_19,
        0 AS SUBTOTALB_19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_20,
        0 AS SUBTOTALB_20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_21,
        0 AS SUBTOTALB_21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_22,
        0 AS SUBTOTALB_22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_23,
        0 AS SUBTOTALB_23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_24,
        0 AS SUBTOTALB_24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_25,
        0 AS SUBTOTALB_25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_26,
        0 AS SUBTOTALB_26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_27,
        0 AS SUBTOTALB_27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_28,
        0 AS SUBTOTALB_28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_29,
        0 AS SUBTOTALB_29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_30,
        0 AS SUBTOTALB_30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_31,
  0 AS SUBTOTALB_31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
CAB.CODCAJA = 90 AND DET.CODCONCEPTO_MOV=90 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

    UNION ALL

    SELECT
        0 AS SUBTOTALA_1,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '01' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_1,
        0 AS SUBTOTALA_2,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '02' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_2,
        0 AS SUBTOTALA_3,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '03' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_3,
        0 AS SUBTOTALA_4,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '04' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_4,
        0 AS SUBTOTALA_5,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '05' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_5,
        0 AS SUBTOTALA_6,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '06' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_6,
        0 AS SUBTOTALA_7,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '07' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_7,
        0 AS SUBTOTALA_8,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '08' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_8,
        0 AS SUBTOTALA_9,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '09' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_9,
        0 AS SUBTOTALA_10,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '10' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_10,
        0 AS SUBTOTALA_11,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '11' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_11,
        0 AS SUBTOTALA_12,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '12' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_12,
        0 AS SUBTOTALA_13,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '13' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_13,
        0 AS SUBTOTALA_14,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '14' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_14,
        0 AS SUBTOTALA_15,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '15' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_15,
        0 AS SUBTOTALA_16,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '16' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_16,
        0 AS SUBTOTALA_17,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '17' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_17,
        0 AS SUBTOTALA_18,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '18' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_18,
        0 AS SUBTOTALA_19,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '19' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_19,
        0 AS SUBTOTALA_20,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '20' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_20,
        0 AS SUBTOTALA_21,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '21' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_21,
        0 AS SUBTOTALA_22,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '22' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_22,
        0 AS SUBTOTALA_23,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '23' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_23,
        0 AS SUBTOTALA_24,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '24' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_24,
        0 AS SUBTOTALA_25,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '25' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_25,
        0 AS SUBTOTALA_26,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '26' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_26,
        0 AS SUBTOTALA_27,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '27' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_27,
        0 AS SUBTOTALA_28,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '28' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_28,
        0 AS SUBTOTALA_29,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '29' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_29,
        0 AS SUBTOTALA_30,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '30' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_30,
        0 AS SUBTOTALA_31,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '31' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_31
    FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
CAB.CODCAJA = 90 AND DET.CODCONCEPTO_MOV=91 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}) AS SI_COFRE_RETIRADA_1)

UNION ALL

SELECT
'S.F. COFRE RETIRADA' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
CAB.CODCAJA = 90 AND DET.CODCONCEPTO_MOV=90 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

(SELECT 'S.I. COFRE + S.I. COFRE RETIRADAS' AS FILA,
       (SUM(SUBTOTALA_1) - ABS(SUM(SUBTOTALB_1)) + SUM(SUBTOTALC_1)) AS TOTAL1,
       (SUM(SUBTOTALA_2) - ABS(SUM(SUBTOTALB_2)) + SUM(SUBTOTALC_2)) AS TOTAL2,
       (SUM(SUBTOTALA_3) - ABS(SUM(SUBTOTALB_3)) + SUM(SUBTOTALC_3)) AS TOTAL3,
       (SUM(SUBTOTALA_4) - ABS(SUM(SUBTOTALB_4)) + SUM(SUBTOTALC_4)) AS TOTAL4,
       (SUM(SUBTOTALA_5) - ABS(SUM(SUBTOTALB_5)) + SUM(SUBTOTALC_5)) AS TOTAL5,
       (SUM(SUBTOTALA_6) - ABS(SUM(SUBTOTALB_6)) + SUM(SUBTOTALC_6)) AS TOTAL6,
       (SUM(SUBTOTALA_7) - ABS(SUM(SUBTOTALB_7)) + SUM(SUBTOTALC_7)) AS TOTAL7,
       (SUM(SUBTOTALA_8) - ABS(SUM(SUBTOTALB_8)) + SUM(SUBTOTALC_8)) AS TOTAL8,
       (SUM(SUBTOTALA_9) - ABS(SUM(SUBTOTALB_9)) + SUM(SUBTOTALC_9)) AS TOTAL9,
       (SUM(SUBTOTALA_10) - ABS(SUM(SUBTOTALB_10)) + SUM(SUBTOTALC_10)) AS TOTAL10,
       (SUM(SUBTOTALA_11) - ABS(SUM(SUBTOTALB_11)) + SUM(SUBTOTALC_11)) AS TOTAL11,
       (SUM(SUBTOTALA_12) - ABS(SUM(SUBTOTALB_12)) + SUM(SUBTOTALC_12)) AS TOTAL12,
       (SUM(SUBTOTALA_13) - ABS(SUM(SUBTOTALB_13)) + SUM(SUBTOTALC_13)) AS TOTAL13,
       (SUM(SUBTOTALA_14) - ABS(SUM(SUBTOTALB_14)) + SUM(SUBTOTALC_14)) AS TOTAL14,
       (SUM(SUBTOTALA_15) - ABS(SUM(SUBTOTALB_15)) + SUM(SUBTOTALC_15)) AS TOTAL15,
       (SUM(SUBTOTALA_16) - ABS(SUM(SUBTOTALB_16)) + SUM(SUBTOTALC_16)) AS TOTAL16,
       (SUM(SUBTOTALA_17) - ABS(SUM(SUBTOTALB_17)) + SUM(SUBTOTALC_17)) AS TOTAL17,
       (SUM(SUBTOTALA_18) - ABS(SUM(SUBTOTALB_18)) + SUM(SUBTOTALC_18)) AS TOTAL18,
       (SUM(SUBTOTALA_19) - ABS(SUM(SUBTOTALB_19)) + SUM(SUBTOTALC_19)) AS TOTAL19,
       (SUM(SUBTOTALA_20) - ABS(SUM(SUBTOTALB_20)) + SUM(SUBTOTALC_20)) AS TOTAL20,
       (SUM(SUBTOTALA_21) - ABS(SUM(SUBTOTALB_21)) + SUM(SUBTOTALC_21)) AS TOTAL21,
       (SUM(SUBTOTALA_22) - ABS(SUM(SUBTOTALB_22)) + SUM(SUBTOTALC_22)) AS TOTAL22,
       (SUM(SUBTOTALA_23) - ABS(SUM(SUBTOTALB_23)) + SUM(SUBTOTALC_23)) AS TOTAL23,
       (SUM(SUBTOTALA_24) - ABS(SUM(SUBTOTALB_24)) + SUM(SUBTOTALC_24)) AS TOTAL24,
       (SUM(SUBTOTALA_25) - ABS(SUM(SUBTOTALB_25)) + SUM(SUBTOTALC_25)) AS TOTAL25,
       (SUM(SUBTOTALA_26) - ABS(SUM(SUBTOTALB_26)) + SUM(SUBTOTALC_26)) AS TOTAL26,
       (SUM(SUBTOTALA_27) - ABS(SUM(SUBTOTALB_27)) + SUM(SUBTOTALC_27)) AS TOTAL27,
       (SUM(SUBTOTALA_28) - ABS(SUM(SUBTOTALB_28)) + SUM(SUBTOTALC_28)) AS TOTAL28,
       (SUM(SUBTOTALA_29) - ABS(SUM(SUBTOTALB_29)) + SUM(SUBTOTALC_29)) AS TOTAL29,
       (SUM(SUBTOTALA_30) - ABS(SUM(SUBTOTALB_30)) + SUM(SUBTOTALC_30)) AS TOTAL30,
       (SUM(SUBTOTALA_31) - ABS(SUM(SUBTOTALB_31)) + SUM(SUBTOTALC_31)) AS TOTAL31
FROM (
    SELECT
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS SUBTOTALA_1,
        0 AS SUBTOTALB_1,
        0 AS SUBTOTALC_1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_2,
        0 AS SUBTOTALB_2,
        0 AS SUBTOTALC_2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_3,
        0 AS SUBTOTALB_3,
        0 AS SUBTOTALC_3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_4,
        0 AS SUBTOTALB_4,
        0 AS SUBTOTALC_4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_5,
        0 AS SUBTOTALB_5,
        0 AS SUBTOTALC_5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_6,
        0 AS SUBTOTALB_6,
        0 AS SUBTOTALC_6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_7,
        0 AS SUBTOTALB_7,
        0 AS SUBTOTALC_7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_8,
        0 AS SUBTOTALB_8,
        0 AS SUBTOTALC_8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_9,
        0 AS SUBTOTALB_9,
        0 AS SUBTOTALC_9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_10,
        0 AS SUBTOTALB_10,
        0 AS SUBTOTALC_10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_11,
        0 AS SUBTOTALB_11,
        0 AS SUBTOTALC_11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_12,
        0 AS SUBTOTALB_12,
        0 AS SUBTOTALC_12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_13,
        0 AS SUBTOTALB_13,
        0 AS SUBTOTALC_13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_14,
        0 AS SUBTOTALB_14,
        0 AS SUBTOTALC_14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_15,
        0 AS SUBTOTALB_15,
        0 AS SUBTOTALC_15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_16,
        0 AS SUBTOTALB_16,
        0 AS SUBTOTALC_16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_17,
        0 AS SUBTOTALB_17,
        0 AS SUBTOTALC_17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_18,
        0 AS SUBTOTALB_18,
        0 AS SUBTOTALC_18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_19,
        0 AS SUBTOTALB_19,
        0 AS SUBTOTALC_19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_20,
        0 AS SUBTOTALB_20,
        0 AS SUBTOTALC_20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_21,
        0 AS SUBTOTALB_21,
        0 AS SUBTOTALC_21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_22,
        0 AS SUBTOTALB_22,
        0 AS SUBTOTALC_22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_23,
        0 AS SUBTOTALB_23,
        0 AS SUBTOTALC_23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_24,
        0 AS SUBTOTALB_24,
        0 AS SUBTOTALC_24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_25,
        0 AS SUBTOTALB_25,
        0 AS SUBTOTALC_25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_26,
        0 AS SUBTOTALB_26,
        0 AS SUBTOTALC_26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_27,
        0 AS SUBTOTALB_27,
        0 AS SUBTOTALC_27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_28,
        0 AS SUBTOTALB_28,
        0 AS SUBTOTALC_28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_29,
        0 AS SUBTOTALB_29,
        0 AS SUBTOTALC_29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_30,
        0 AS SUBTOTALB_30,
        0 AS SUBTOTALC_30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_31,
  0 AS SUBTOTALB_31,
        0 AS SUBTOTALC_31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
CAB.CODCAJA = 90 AND DET.CODCONCEPTO_MOV=90 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

    UNION ALL

    SELECT
        0 AS SUBTOTALA_1,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '01' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_1,
        0 AS SUBTOTALC_1,
        0 AS SUBTOTALA_2,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '02' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_2,
        0 AS SUBTOTALC_2,
        0 AS SUBTOTALA_3,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '03' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_3,
        0 AS SUBTOTALC_3,
        0 AS SUBTOTALA_4,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '04' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_4,
        0 AS SUBTOTALC_4,
        0 AS SUBTOTALA_5,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '05' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_5,
        0 AS SUBTOTALC_5,
        0 AS SUBTOTALA_6,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '06' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_6,
        0 AS SUBTOTALC_6,
        0 AS SUBTOTALA_7,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '07' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_7,
        0 AS SUBTOTALC_7,
        0 AS SUBTOTALA_8,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '08' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_8,
        0 AS SUBTOTALC_8,
        0 AS SUBTOTALA_9,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '09' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_9,
        0 AS SUBTOTALC_9,
        0 AS SUBTOTALA_10,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '10' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_10,
        0 AS SUBTOTALC_10,
        0 AS SUBTOTALA_11,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '11' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_11,
        0 AS SUBTOTALC_11,
        0 AS SUBTOTALA_12,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '12' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_12,
        0 AS SUBTOTALC_12,
        0 AS SUBTOTALA_13,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '13' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_13,
        0 AS SUBTOTALC_13,
        0 AS SUBTOTALA_14,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '14' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_14,
        0 AS SUBTOTALC_14,
        0 AS SUBTOTALA_15,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '15' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_15,
        0 AS SUBTOTALC_15,
        0 AS SUBTOTALA_16,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '16' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_16,
        0 AS SUBTOTALC_16,
        0 AS SUBTOTALA_17,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '17' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_17,
        0 AS SUBTOTALC_17,
        0 AS SUBTOTALA_18,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '18' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_18,
        0 AS SUBTOTALC_18,
        0 AS SUBTOTALA_19,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '19' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_19,
        0 AS SUBTOTALC_19,
        0 AS SUBTOTALA_20,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '20' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_20,
        0 AS SUBTOTALC_20,
        0 AS SUBTOTALA_21,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '21' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_21,
        0 AS SUBTOTALC_21,
        0 AS SUBTOTALA_22,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '22' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_22,
        0 AS SUBTOTALC_22,
        0 AS SUBTOTALA_23,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '23' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_23,
        0 AS SUBTOTALC_23,
        0 AS SUBTOTALA_24,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '24' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_24,
        0 AS SUBTOTALC_24,
        0 AS SUBTOTALA_25,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '25' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_25,
        0 AS SUBTOTALC_25,
        0 AS SUBTOTALA_26,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '26' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_26,
        0 AS SUBTOTALC_26,
        0 AS SUBTOTALA_27,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '27' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_27,
        0 AS SUBTOTALC_27,
        0 AS SUBTOTALA_28,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '28' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_28,
        0 AS SUBTOTALC_28,
        0 AS SUBTOTALA_29,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '29' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_29,
        0 AS SUBTOTALC_29,
        0 AS SUBTOTALA_30,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '30' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_30,
        0 AS SUBTOTALC_30,
        0 AS SUBTOTALA_31,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '31' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_31,
        0 AS SUBTOTALC_31
    FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
CAB.CODCAJA = 90 AND DET.CODCONCEPTO_MOV=91 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
0 AS SUBTOTALA_1,
0 AS SUBTOTALB_1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALC_1,
0 AS SUBTOTALA_2,
0 AS SUBTOTALB_2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_2,
0 AS SUBTOTALA_3,
0 AS SUBTOTALB_3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_3,
0 AS SUBTOTALA_4,
0 AS SUBTOTALB_4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_4,
0 AS SUBTOTALA_5,
0 AS SUBTOTALB_5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_5,
0 AS SUBTOTALA_6,
0 AS SUBTOTALB_6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_6,
0 AS SUBTOTALA_7,
0 AS SUBTOTALB_7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_7,
0 AS SUBTOTALA_8,
0 AS SUBTOTALB_8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_8,
0 AS SUBTOTALA_9,
0 AS SUBTOTALB_9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_9,
0 AS SUBTOTALA_10,
0 AS SUBTOTALB_10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_10,
0 AS SUBTOTALA_11,
0 AS SUBTOTALB_11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_11,
0 AS SUBTOTALA_12,
0 AS SUBTOTALB_12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_12,
0 AS SUBTOTALA_13,
0 AS SUBTOTALB_13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_13,
0 AS SUBTOTALA_14,
0 AS SUBTOTALB_14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_14,
0 AS SUBTOTALA_15,
0 AS SUBTOTALB_15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_15,
0 AS SUBTOTALA_16,
0 AS SUBTOTALB_16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_16,
0 AS SUBTOTALA_17,
0 AS SUBTOTALB_17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_17,
0 AS SUBTOTALA_18,
0 AS SUBTOTALB_18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_18,
0 AS SUBTOTALA_19,
0 AS SUBTOTALB_19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_19,
0 AS SUBTOTALA_20,
0 AS SUBTOTALB_20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_20,
0 AS SUBTOTALA_21,
0 AS SUBTOTALB_21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_21,
0 AS SUBTOTALA_22,
0 AS SUBTOTALB_22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_22,
0 AS SUBTOTALA_23,
0 AS SUBTOTALB_23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_23,
0 AS SUBTOTALA_24,
0 AS SUBTOTALB_24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_24,
0 AS SUBTOTALA_25,
0 AS SUBTOTALB_25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_25,
0 AS SUBTOTALA_26,
0 AS SUBTOTALB_26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_26,
0 AS SUBTOTALA_27,
0 AS SUBTOTALB_27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_27,
0 AS SUBTOTALA_28,
0 AS SUBTOTALB_28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_28,
0 AS SUBTOTALA_29,
0 AS SUBTOTALB_29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_29,
0 AS SUBTOTALA_30,
0 AS SUBTOTALB_30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_30,
0 AS SUBTOTALA_31,
0 AS SUBTOTALB_31,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
CAB.CODCAJA =80 and DET.CODCONCEPTO_MOV = 00 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}) AS SI_COFRE_RETIRADA_1)

UNION ALL

(SELECT 'TOTAL COFRES 26010800' AS FILA,
       (SUM(SUBTOTALA_1) + SUM(SUBTOTALB_1)) AS TOTAL1,
       (SUM(SUBTOTALA_2) + SUM(SUBTOTALB_2)) AS TOTAL2,
       (SUM(SUBTOTALA_3) + SUM(SUBTOTALB_3)) AS TOTAL3,
       (SUM(SUBTOTALA_4) + SUM(SUBTOTALB_4)) AS TOTAL4,
       (SUM(SUBTOTALA_5) + SUM(SUBTOTALB_5)) AS TOTAL5,
       (SUM(SUBTOTALA_6) + SUM(SUBTOTALB_6)) AS TOTAL6,
       (SUM(SUBTOTALA_7) + SUM(SUBTOTALB_7)) AS TOTAL7,
       (SUM(SUBTOTALA_8) + SUM(SUBTOTALB_8)) AS TOTAL8,
       (SUM(SUBTOTALA_9) + SUM(SUBTOTALB_9)) AS TOTAL9,
       (SUM(SUBTOTALA_10) + SUM(SUBTOTALB_10)) AS TOTAL10,
       (SUM(SUBTOTALA_11) + SUM(SUBTOTALB_11)) AS TOTAL11,
       (SUM(SUBTOTALA_12) + SUM(SUBTOTALB_12)) AS TOTAL12,
       (SUM(SUBTOTALA_13) + SUM(SUBTOTALB_13)) AS TOTAL13,
       (SUM(SUBTOTALA_14) + SUM(SUBTOTALB_14)) AS TOTAL14,
       (SUM(SUBTOTALA_15) + SUM(SUBTOTALB_15)) AS TOTAL15,
       (SUM(SUBTOTALA_16) + SUM(SUBTOTALB_16)) AS TOTAL16,
       (SUM(SUBTOTALA_17) + SUM(SUBTOTALB_17)) AS TOTAL17,
       (SUM(SUBTOTALA_18) + SUM(SUBTOTALB_18)) AS TOTAL18,
       (SUM(SUBTOTALA_19) + SUM(SUBTOTALB_19)) AS TOTAL19,
       (SUM(SUBTOTALA_20) + SUM(SUBTOTALB_20)) AS TOTAL20,
       (SUM(SUBTOTALA_21) + SUM(SUBTOTALB_21)) AS TOTAL21,
       (SUM(SUBTOTALA_22) + SUM(SUBTOTALB_22)) AS TOTAL22,
       (SUM(SUBTOTALA_23) + SUM(SUBTOTALB_23)) AS TOTAL23,
       (SUM(SUBTOTALA_24) + SUM(SUBTOTALB_24)) AS TOTAL24,
       (SUM(SUBTOTALA_25) + SUM(SUBTOTALB_25)) AS TOTAL25,
       (SUM(SUBTOTALA_26) + SUM(SUBTOTALB_26)) AS TOTAL26,
       (SUM(SUBTOTALA_27) + SUM(SUBTOTALB_27)) AS TOTAL27,
       (SUM(SUBTOTALA_28) + SUM(SUBTOTALB_28)) AS TOTAL28,
       (SUM(SUBTOTALA_29) + SUM(SUBTOTALB_29)) AS TOTAL29,
       (SUM(SUBTOTALA_30) + SUM(SUBTOTALB_30)) AS TOTAL30,
       (SUM(SUBTOTALA_31) + SUM(SUBTOTALB_31)) AS TOTAL31
FROM (
    SELECT
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS SUBTOTALA_1,
        0 AS SUBTOTALB_1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_2,
        0 AS SUBTOTALB_2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_3,
        0 AS SUBTOTALB_3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_4,
        0 AS SUBTOTALB_4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_5,
        0 AS SUBTOTALB_5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_6,
        0 AS SUBTOTALB_6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_7,
        0 AS SUBTOTALB_7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_8,
        0 AS SUBTOTALB_8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_9,
        0 AS SUBTOTALB_9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_10,
        0 AS SUBTOTALB_10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_11,
        0 AS SUBTOTALB_11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_12,
        0 AS SUBTOTALB_12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_13,
        0 AS SUBTOTALB_13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_14,
        0 AS SUBTOTALB_14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_15,
        0 AS SUBTOTALB_15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_16,
        0 AS SUBTOTALB_16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_17,
        0 AS SUBTOTALB_17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_18,
        0 AS SUBTOTALB_18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_19,
        0 AS SUBTOTALB_19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_20,
        0 AS SUBTOTALB_20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_21,
        0 AS SUBTOTALB_21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_22,
        0 AS SUBTOTALB_22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_23,
        0 AS SUBTOTALB_23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_24,
        0 AS SUBTOTALB_24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_25,
        0 AS SUBTOTALB_25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_26,
        0 AS SUBTOTALB_26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_27,
        0 AS SUBTOTALB_27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_28,
        0 AS SUBTOTALB_28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_29,
        0 AS SUBTOTALB_29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_30,
        0 AS SUBTOTALB_30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_31,
  0 AS SUBTOTALB_31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
CAB.CODCAJA = 80 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

    UNION ALL

    SELECT
        0 AS SUBTOTALA_1,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '01' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_1,
        0 AS SUBTOTALA_2,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '02' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_2,
        0 AS SUBTOTALA_3,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '03' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_3,
        0 AS SUBTOTALA_4,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '04' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_4,
        0 AS SUBTOTALA_5,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '05' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_5,
        0 AS SUBTOTALA_6,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '06' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_6,
        0 AS SUBTOTALA_7,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '07' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_7,
        0 AS SUBTOTALA_8,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '08' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_8,
        0 AS SUBTOTALA_9,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '09' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_9,
        0 AS SUBTOTALA_10,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '10' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_10,
        0 AS SUBTOTALA_11,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '11' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_11,
        0 AS SUBTOTALA_12,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '12' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_12,
        0 AS SUBTOTALA_13,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '13' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_13,
        0 AS SUBTOTALA_14,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '14' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_14,
        0 AS SUBTOTALA_15,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '15' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_15,
        0 AS SUBTOTALA_16,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '16' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_16,
        0 AS SUBTOTALA_17,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '17' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_17,
        0 AS SUBTOTALA_18,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '18' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_18,
        0 AS SUBTOTALA_19,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '19' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_19,
        0 AS SUBTOTALA_20,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '20' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_20,
        0 AS SUBTOTALA_21,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '21' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_21,
        0 AS SUBTOTALA_22,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '22' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_22,
        0 AS SUBTOTALA_23,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '23' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_23,
        0 AS SUBTOTALA_24,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '24' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_24,
        0 AS SUBTOTALA_25,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '25' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_25,
        0 AS SUBTOTALA_26,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '26' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_26,
        0 AS SUBTOTALA_27,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '27' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_27,
        0 AS SUBTOTALA_28,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '28' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_28,
        0 AS SUBTOTALA_29,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '29' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_29,
        0 AS SUBTOTALA_30,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '30' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_30,
        0 AS SUBTOTALA_31,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '31' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_31
    FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
CAB.CODCAJA = 90 AND DET.CODCONCEPTO_MOV=90 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}) AS TOTAL_COFRES_26010800)

UNION ALL

(SELECT 'APORTACION 26010800' AS FILA,
       (ABS(SUM(SUBTOTALA_1)) - ABS(SUM(SUBTOTALB_1)) - ABS(SUM(SUBTOTALC_1))) AS TOTAL1,
       (ABS(SUM(SUBTOTALA_2)) - ABS(SUM(SUBTOTALB_2)) - ABS(SUM(SUBTOTALC_2))) AS TOTAL2,
       (ABS(SUM(SUBTOTALA_3)) - ABS(SUM(SUBTOTALB_3)) - ABS(SUM(SUBTOTALC_3))) AS TOTAL3,
       (ABS(SUM(SUBTOTALA_4)) - ABS(SUM(SUBTOTALB_4)) - ABS(SUM(SUBTOTALC_4))) AS TOTAL4,
       (ABS(SUM(SUBTOTALA_5)) - ABS(SUM(SUBTOTALB_5)) - ABS(SUM(SUBTOTALC_5))) AS TOTAL5,
       (ABS(SUM(SUBTOTALA_6)) - ABS(SUM(SUBTOTALB_6)) - ABS(SUM(SUBTOTALC_6))) AS TOTAL6,
       (ABS(SUM(SUBTOTALA_7)) - ABS(SUM(SUBTOTALB_7)) - ABS(SUM(SUBTOTALC_7))) AS TOTAL7,
       (ABS(SUM(SUBTOTALA_8)) - ABS(SUM(SUBTOTALB_8)) - ABS(SUM(SUBTOTALC_8))) AS TOTAL8,
       (ABS(SUM(SUBTOTALA_9)) - ABS(SUM(SUBTOTALB_9)) - ABS(SUM(SUBTOTALC_9))) AS TOTAL9,
       (ABS(SUM(SUBTOTALA_10)) - ABS(SUM(SUBTOTALB_10)) - ABS(SUM(SUBTOTALC_10))) AS TOTAL10,
       (ABS(SUM(SUBTOTALA_11)) - ABS(SUM(SUBTOTALB_11)) - ABS(SUM(SUBTOTALC_11))) AS TOTAL11,
       (ABS(SUM(SUBTOTALA_12)) - ABS(SUM(SUBTOTALB_12)) - ABS(SUM(SUBTOTALC_12))) AS TOTAL12,
       (ABS(SUM(SUBTOTALA_13)) - ABS(SUM(SUBTOTALB_13)) - ABS(SUM(SUBTOTALC_13))) AS TOTAL13,
       (ABS(SUM(SUBTOTALA_14)) - ABS(SUM(SUBTOTALB_14)) - ABS(SUM(SUBTOTALC_14))) AS TOTAL14,
       (ABS(SUM(SUBTOTALA_15)) - ABS(SUM(SUBTOTALB_15)) - ABS(SUM(SUBTOTALC_15))) AS TOTAL15,
       (ABS(SUM(SUBTOTALA_16)) - ABS(SUM(SUBTOTALB_16)) - ABS(SUM(SUBTOTALC_16))) AS TOTAL16,
       (ABS(SUM(SUBTOTALA_17)) - ABS(SUM(SUBTOTALB_17)) - ABS(SUM(SUBTOTALC_17))) AS TOTAL17,
       (ABS(SUM(SUBTOTALA_18)) - ABS(SUM(SUBTOTALB_18)) - ABS(SUM(SUBTOTALC_18))) AS TOTAL18,
       (ABS(SUM(SUBTOTALA_19)) - ABS(SUM(SUBTOTALB_19)) - ABS(SUM(SUBTOTALC_19))) AS TOTAL19,
       (ABS(SUM(SUBTOTALA_20)) - ABS(SUM(SUBTOTALB_20)) - ABS(SUM(SUBTOTALC_20))) AS TOTAL20,
       (ABS(SUM(SUBTOTALA_21)) - ABS(SUM(SUBTOTALB_21)) - ABS(SUM(SUBTOTALC_21))) AS TOTAL21,
       (ABS(SUM(SUBTOTALA_22)) - ABS(SUM(SUBTOTALB_22)) - ABS(SUM(SUBTOTALC_22))) AS TOTAL22,
       (ABS(SUM(SUBTOTALA_23)) - ABS(SUM(SUBTOTALB_23)) - ABS(SUM(SUBTOTALC_23))) AS TOTAL23,
       (ABS(SUM(SUBTOTALA_24)) - ABS(SUM(SUBTOTALB_24)) - ABS(SUM(SUBTOTALC_24))) AS TOTAL24,
       (ABS(SUM(SUBTOTALA_25)) - ABS(SUM(SUBTOTALB_25)) - ABS(SUM(SUBTOTALC_25))) AS TOTAL25,
       (ABS(SUM(SUBTOTALA_26)) - ABS(SUM(SUBTOTALB_26)) - ABS(SUM(SUBTOTALC_26))) AS TOTAL26,
       (ABS(SUM(SUBTOTALA_27)) - ABS(SUM(SUBTOTALB_27)) - ABS(SUM(SUBTOTALC_27))) AS TOTAL27,
       (ABS(SUM(SUBTOTALA_28)) - ABS(SUM(SUBTOTALB_28)) - ABS(SUM(SUBTOTALC_28))) AS TOTAL28,
       (ABS(SUM(SUBTOTALA_29)) - ABS(SUM(SUBTOTALB_29)) - ABS(SUM(SUBTOTALC_29))) AS TOTAL29,
       (ABS(SUM(SUBTOTALA_30)) - ABS(SUM(SUBTOTALB_30)) - ABS(SUM(SUBTOTALC_30))) AS TOTAL30,
       (ABS(SUM(SUBTOTALA_31)) - ABS(SUM(SUBTOTALB_31)) - ABS(SUM(SUBTOTALC_31))) AS TOTAL31
FROM (
    SELECT
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS SUBTOTALA_1,
        0 AS SUBTOTALB_1,
        0 AS SUBTOTALC_1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_2,
        0 AS SUBTOTALB_2,
        0 AS SUBTOTALC_2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_3,
        0 AS SUBTOTALB_3,
        0 AS SUBTOTALC_3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_4,
        0 AS SUBTOTALB_4,
        0 AS SUBTOTALC_4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_5,
        0 AS SUBTOTALB_5,
        0 AS SUBTOTALC_5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_6,
        0 AS SUBTOTALB_6,
        0 AS SUBTOTALC_6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_7,
        0 AS SUBTOTALB_7,
        0 AS SUBTOTALC_7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_8,
        0 AS SUBTOTALB_8,
        0 AS SUBTOTALC_8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_9,
        0 AS SUBTOTALB_9,
        0 AS SUBTOTALC_9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_10,
        0 AS SUBTOTALB_10,
        0 AS SUBTOTALC_10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_11,
        0 AS SUBTOTALB_11,
        0 AS SUBTOTALC_11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_12,
        0 AS SUBTOTALB_12,
        0 AS SUBTOTALC_12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_13,
        0 AS SUBTOTALB_13,
        0 AS SUBTOTALC_13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_14,
        0 AS SUBTOTALB_14,
        0 AS SUBTOTALC_14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_15,
        0 AS SUBTOTALB_15,
        0 AS SUBTOTALC_15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_16,
        0 AS SUBTOTALB_16,
        0 AS SUBTOTALC_16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_17,
        0 AS SUBTOTALB_17,
        0 AS SUBTOTALC_17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_18,
        0 AS SUBTOTALB_18,
        0 AS SUBTOTALC_18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_19,
        0 AS SUBTOTALB_19,
        0 AS SUBTOTALC_19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_20,
        0 AS SUBTOTALB_20,
        0 AS SUBTOTALC_20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_21,
        0 AS SUBTOTALB_21,
        0 AS SUBTOTALC_21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_22,
        0 AS SUBTOTALB_22,
        0 AS SUBTOTALC_22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_23,
        0 AS SUBTOTALB_23,
        0 AS SUBTOTALC_23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_24,
        0 AS SUBTOTALB_24,
        0 AS SUBTOTALC_24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_25,
        0 AS SUBTOTALB_25,
        0 AS SUBTOTALC_25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_26,
        0 AS SUBTOTALB_26,
        0 AS SUBTOTALC_26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_27,
        0 AS SUBTOTALB_27,
        0 AS SUBTOTALC_27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_28,
        0 AS SUBTOTALB_28,
        0 AS SUBTOTALC_28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_29,
        0 AS SUBTOTALB_29,
        0 AS SUBTOTALC_29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_30,
        0 AS SUBTOTALB_30,
        0 AS SUBTOTALC_30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_31,
  0 AS SUBTOTALB_31,
        0 AS SUBTOTALC_31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
CAB.CODCAJA =80 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

    UNION ALL

    SELECT
        0 AS SUBTOTALA_1,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '01' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_1,
        0 AS SUBTOTALC_1,
        0 AS SUBTOTALA_2,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '02' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_2,
        0 AS SUBTOTALC_2,
        0 AS SUBTOTALA_3,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '03' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_3,
        0 AS SUBTOTALC_3,
        0 AS SUBTOTALA_4,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '04' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_4,
        0 AS SUBTOTALC_4,
        0 AS SUBTOTALA_5,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '05' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_5,
        0 AS SUBTOTALC_5,
        0 AS SUBTOTALA_6,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '06' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_6,
        0 AS SUBTOTALC_6,
        0 AS SUBTOTALA_7,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '07' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_7,
        0 AS SUBTOTALC_7,
        0 AS SUBTOTALA_8,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '08' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_8,
        0 AS SUBTOTALC_8,
        0 AS SUBTOTALA_9,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '09' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_9,
        0 AS SUBTOTALC_9,
        0 AS SUBTOTALA_10,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '10' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_10,
        0 AS SUBTOTALC_10,
        0 AS SUBTOTALA_11,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '11' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_11,
        0 AS SUBTOTALC_11,
        0 AS SUBTOTALA_12,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '12' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_12,
        0 AS SUBTOTALC_12,
        0 AS SUBTOTALA_13,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '13' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_13,
        0 AS SUBTOTALC_13,
        0 AS SUBTOTALA_14,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '14' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_14,
        0 AS SUBTOTALC_14,
        0 AS SUBTOTALA_15,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '15' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_15,
        0 AS SUBTOTALC_15,
        0 AS SUBTOTALA_16,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '16' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_16,
        0 AS SUBTOTALC_16,
        0 AS SUBTOTALA_17,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '17' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_17,
        0 AS SUBTOTALC_17,
        0 AS SUBTOTALA_18,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '18' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_18,
        0 AS SUBTOTALC_18,
        0 AS SUBTOTALA_19,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '19' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_19,
        0 AS SUBTOTALC_19,
        0 AS SUBTOTALA_20,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '20' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_20,
        0 AS SUBTOTALC_20,
        0 AS SUBTOTALA_21,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '21' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_21,
        0 AS SUBTOTALC_21,
        0 AS SUBTOTALA_22,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '22' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_22,
        0 AS SUBTOTALC_22,
        0 AS SUBTOTALA_23,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '23' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_23,
        0 AS SUBTOTALC_23,
        0 AS SUBTOTALA_24,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '24' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_24,
        0 AS SUBTOTALC_24,
        0 AS SUBTOTALA_25,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '25' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_25,
        0 AS SUBTOTALC_25,
        0 AS SUBTOTALA_26,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '26' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_26,
        0 AS SUBTOTALC_26,
        0 AS SUBTOTALA_27,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '27' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_27,
        0 AS SUBTOTALC_27,
        0 AS SUBTOTALA_28,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '28' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_28,
        0 AS SUBTOTALC_28,
        0 AS SUBTOTALA_29,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '29' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_29,
        0 AS SUBTOTALC_29,
        0 AS SUBTOTALA_30,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '30' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_30,
        0 AS SUBTOTALC_30,
        0 AS SUBTOTALA_31,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '31' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_31,
        0 AS SUBTOTALC_31
    FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
DET.CODCONCEPTO_MOV = 82 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
0 AS SUBTOTALA_1,
0 AS SUBTOTALB_1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALC_1,
0 AS SUBTOTALA_2,
0 AS SUBTOTALB_2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL2,
0 AS SUBTOTALA_3,
0 AS SUBTOTALB_3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL3,
0 AS SUBTOTALA_4,
0 AS SUBTOTALB_4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL4,
0 AS SUBTOTALA_5,
0 AS SUBTOTALB_5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL5,
0 AS SUBTOTALA_6,
0 AS SUBTOTALB_6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL6,
0 AS SUBTOTALA_7,
0 AS SUBTOTALB_7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL7,
0 AS SUBTOTALA_8,
0 AS SUBTOTALB_8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL8,
0 AS SUBTOTALA_9,
0 AS SUBTOTALB_9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL9,
0 AS SUBTOTALA_10,
0 AS SUBTOTALB_10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL10,
0 AS SUBTOTALA_11,
0 AS SUBTOTALB_11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL11,
0 AS SUBTOTALA_12,
0 AS SUBTOTALB_12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL12,
0 AS SUBTOTALA_13,
0 AS SUBTOTALB_13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL13,
0 AS SUBTOTALA_14,
0 AS SUBTOTALB_14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL14,
0 AS SUBTOTALA_15,
0 AS SUBTOTALB_15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL15,
0 AS SUBTOTALA_16,
0 AS SUBTOTALB_16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL16,
0 AS SUBTOTALA_17,
0 AS SUBTOTALB_17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL17,
0 AS SUBTOTALA_18,
0 AS SUBTOTALB_18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL18,
0 AS SUBTOTALA_19,
0 AS SUBTOTALB_19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL19,
0 AS SUBTOTALA_20,
0 AS SUBTOTALB_20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL20,
0 AS SUBTOTALA_21,
0 AS SUBTOTALB_21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL21,
0 AS SUBTOTALA_22,
0 AS SUBTOTALB_22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL22,
0 AS SUBTOTALA_23,
0 AS SUBTOTALB_23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL23,
0 AS SUBTOTALA_24,
0 AS SUBTOTALB_24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL24,
0 AS SUBTOTALA_25,
0 AS SUBTOTALB_25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL25,
0 AS SUBTOTALA_26,
0 AS SUBTOTALB_26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL26,
0 AS SUBTOTALA_27,
0 AS SUBTOTALB_27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL27,
0 AS SUBTOTALA_28,
0 AS SUBTOTALB_28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL28,
0 AS SUBTOTALA_29,
0 AS SUBTOTALB_29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL29,
0 AS SUBTOTALA_30,
0 AS SUBTOTALB_30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL30,
0 AS SUBTOTALA_31,
0 AS SUBTOTALB_31,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
CAB.CODCAJA =80 and DET.CODCONCEPTO_MOV = 00 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}) AS APORTACION_26010800)


UNION ALL

SELECT
'ANTICIPOS PAGADOS 33359200' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (ANT.IMPORTE) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA) INNER JOIN
	D_CLIE_ALBARANES_CAB_TBL ALB ON (ALB.UID_ACTIVIDAD   = CAB.UID_ACTIVIDAD AND
						   			 ALB.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA) INNER JOIN
	X_ANTICIPOS_TBL ANT ON (ANT.UID_ACTIVIDAD   = ALB.UID_ACTIVIDAD AND
							ANT.ID_CLIE_ALBARAN = ALB.ID_CLIE_ALBARAN)
WHERE
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
'ANTICIPOS DESCONTADOS 33359200' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (ANT.IMPORTE) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (ANT.IMPORTE) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA) INNER JOIN
	D_CLIE_ALBARANES_CAB_TBL ALB ON (ALB.UID_ACTIVIDAD   = CAB.UID_ACTIVIDAD AND
						   			 ALB.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA) INNER JOIN
	X_ANTICIPOS_TBL ANT ON (ANT.UID_ACTIVIDAD   = ALB.UID_ACTIVIDAD AND
							ANT.ID_CLIE_ALBARAN = ALB.ID_CLIE_ALBARAN)
	WHERE
	ANT.ESTADO = 'LIQUIDADO' AND ALB.TOTAL > 0 AND ALB.ID_TIPO_DOCUMENTO <> 3 AND ALB.ID_TIPO_DOCUMENTO <> 1003 AND ALB.ID_TIPO_DOCUMENTO <> 11 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
'PAGO A PROVEEDOR 26010900' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
DET.CODCONCEPTO_MOV = 03 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
'RETIRADA 26100500' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
DET.CODCONCEPTO_MOV = 02 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
'EFECTIVO 26010400' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
DET.CODMEDPAG = 0000 AND DET.CODCONCEPTO_MOV IS NULL AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
'TARJETA 20510330' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
DET.CODMEDPAG = 0010 AND DET.CODCONCEPTO_MOV IS NULL AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
'TARJETA MANUAL 20510330' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
DET.CODMEDPAG = 0011 AND DET.CODCONCEPTO_MOV IS NULL AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
'ES FINANCIACION 20520930' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
DET.CODMEDPAG = 2001 AND DET.CODCONCEPTO_MOV IS NULL AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
'PT FINANCIACION 20535200' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
DET.CODMEDPAG = 2002 AND DET.CODCONCEPTO_MOV IS NULL AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
'ECOMMERCE 24900100' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
DET.CODMEDPAG = 0402 AND DET.CODCONCEPTO_MOV IS NULL AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
'VALE FLEXPOINT 42011400' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_DET_TBL DET INNER JOIN
	D_CLIE_ALBARANES_CAB_TBL CAB ON (CAB.UID_ACTIVIDAD     = DET.UID_ACTIVIDAD AND
									 CAB.UID_DIARIO_CAJA   = DET.UID_DIARIO_CAJA AND
									 CAB.ID_TIPO_DOCUMENTO = DET.ID_TIPO_DOCUMENTO) INNER JOIN
	F_TARJETAS_TBL TAR ON (TAR.NUMERO_TARJETA  = CAB.TARJETA_FIDELIZACION)
WHERE
	DET.CODMEDPAG = 1000 AND DET.CODCONCEPTO_MOV IS NULL AND TAR.CODTIPOTARJ ='AB' AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
'VALE COMERZZIA 42011400' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_DET_TBL DET INNER JOIN
	D_CLIE_ALBARANES_CAB_TBL CAB ON (CAB.UID_ACTIVIDAD = DET.UID_ACTIVIDAD AND
									 CAB.UID_DIARIO_CAJA = DET.UID_DIARIO_CAJA AND
									 CAB.ID_TIPO_DOCUMENTO = DET.ID_TIPO_DOCUMENTO) INNER JOIN
	F_TARJETAS_TBL TAR ON (TAR.NUMERO_TARJETA  = CAB.TARJETA_FIDELIZACION)
WHERE
	DET.CODMEDPAG = 0010 AND DET.CODCONCEPTO_MOV IS NULL AND TAR.CODTIPOTARJ ='ABC' AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
'GIFT CARD 42010181' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_DET_TBL DET INNER JOIN
	D_CLIE_ALBARANES_CAB_TBL CAB ON (CAB.UID_ACTIVIDAD = DET.UID_ACTIVIDAD AND
									 CAB.UID_DIARIO_CAJA = DET.UID_DIARIO_CAJA AND
									 CAB.ID_TIPO_DOCUMENTO = DET.ID_TIPO_DOCUMENTO) INNER JOIN
	F_TARJETAS_TBL TAR ON (TAR.NUMERO_TARJETA  = CAB.TARJETA_FIDELIZACION)
WHERE
	DET.CODMEDPAG = 0020 AND DET.CODCONCEPTO_MOV IS NULL AND (TAR.CODTIPOTARJ = 'GC' OR TAR.CODTIPOTARJ = 'R') AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
'TARJETA FIDELIZADO 42010181' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_DET_TBL DET INNER JOIN
	D_CLIE_ALBARANES_CAB_TBL CAB ON (CAB.UID_ACTIVIDAD = DET.UID_ACTIVIDAD AND
									 CAB.UID_DIARIO_CAJA = DET.UID_DIARIO_CAJA AND
									 CAB.ID_TIPO_DOCUMENTO = DET.ID_TIPO_DOCUMENTO) INNER JOIN
	F_TARJETAS_TBL TAR ON (TAR.NUMERO_TARJETA  = CAB.TARJETA_FIDELIZACION)
WHERE
	DET.CODMEDPAG = 0020 AND DET.CODCONCEPTO_MOV IS NULL AND TAR.CODTIPOTARJ = 'P' AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
'CLIENTE A CUENTA' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_DET_TBL DET INNER JOIN
	D_CLIE_ALBARANES_CAB_TBL CAB ON (CAB.UID_ACTIVIDAD = DET.UID_ACTIVIDAD AND
									 CAB.UID_DIARIO_CAJA = DET.UID_DIARIO_CAJA AND
									 CAB.ID_TIPO_DOCUMENTO = DET.ID_TIPO_DOCUMENTO)
WHERE
	CODMEDPAG = 0600 AND CODCONCEPTO_MOV IS NULL AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

(SELECT 'TOTAL DIF SOBRANTE' AS FILA,
       (SUM(SUBTOTALA_1) + SUM(SUBTOTALB_1) - ABS(SUM(SUBTOTALC_1)) - ABS(SUM(SUBTOTALD_1))) AS TOTAL1,
       (SUM(SUBTOTALA_2) + SUM(SUBTOTALB_2) - ABS(SUM(SUBTOTALC_2)) - ABS(SUM(SUBTOTALD_2))) AS TOTAL2,
       (SUM(SUBTOTALA_3) + SUM(SUBTOTALB_3) - ABS(SUM(SUBTOTALC_3)) - ABS(SUM(SUBTOTALD_3))) AS TOTAL3,
       (SUM(SUBTOTALA_4) + SUM(SUBTOTALB_4) - ABS(SUM(SUBTOTALC_4)) - ABS(SUM(SUBTOTALD_4))) AS TOTAL4,
       (SUM(SUBTOTALA_5) + SUM(SUBTOTALB_5) - ABS(SUM(SUBTOTALC_5)) - ABS(SUM(SUBTOTALD_5))) AS TOTAL5,
       (SUM(SUBTOTALA_6) + SUM(SUBTOTALB_6) - ABS(SUM(SUBTOTALC_6)) - ABS(SUM(SUBTOTALD_6))) AS TOTAL6,
       (SUM(SUBTOTALA_7) + SUM(SUBTOTALB_7) - ABS(SUM(SUBTOTALC_7)) - ABS(SUM(SUBTOTALD_7))) AS TOTAL7,
       (SUM(SUBTOTALA_8) + SUM(SUBTOTALB_8) - ABS(SUM(SUBTOTALC_8)) - ABS(SUM(SUBTOTALD_8))) AS TOTAL8,
       (SUM(SUBTOTALA_9) + SUM(SUBTOTALB_9) - ABS(SUM(SUBTOTALC_9)) - ABS(SUM(SUBTOTALD_9))) AS TOTAL9,
       (SUM(SUBTOTALA_10) + SUM(SUBTOTALB_10) - ABS(SUM(SUBTOTALC_10)) - ABS(SUM(SUBTOTALD_10))) AS TOTAL10,
       (SUM(SUBTOTALA_11) + SUM(SUBTOTALB_11) - ABS(SUM(SUBTOTALC_11)) - ABS(SUM(SUBTOTALD_11))) AS TOTAL11,
       (SUM(SUBTOTALA_12) + SUM(SUBTOTALB_12) - ABS(SUM(SUBTOTALC_12)) - ABS(SUM(SUBTOTALD_12))) AS TOTAL12,
       (SUM(SUBTOTALA_13) + SUM(SUBTOTALB_13) - ABS(SUM(SUBTOTALC_13)) - ABS(SUM(SUBTOTALD_13))) AS TOTAL13,
       (SUM(SUBTOTALA_14) + SUM(SUBTOTALB_14) - ABS(SUM(SUBTOTALC_14)) - ABS(SUM(SUBTOTALD_14))) AS TOTAL14,
       (SUM(SUBTOTALA_15) + SUM(SUBTOTALB_15) - ABS(SUM(SUBTOTALC_15)) - ABS(SUM(SUBTOTALD_15))) AS TOTAL15,
       (SUM(SUBTOTALA_16) + SUM(SUBTOTALB_16) - ABS(SUM(SUBTOTALC_16)) - ABS(SUM(SUBTOTALD_16))) AS TOTAL16,
       (SUM(SUBTOTALA_17) + SUM(SUBTOTALB_17) - ABS(SUM(SUBTOTALC_17)) - ABS(SUM(SUBTOTALD_17))) AS TOTAL17,
       (SUM(SUBTOTALA_18) + SUM(SUBTOTALB_18) - ABS(SUM(SUBTOTALC_18)) - ABS(SUM(SUBTOTALD_18))) AS TOTAL18,
       (SUM(SUBTOTALA_19) + SUM(SUBTOTALB_19) - ABS(SUM(SUBTOTALC_19)) - ABS(SUM(SUBTOTALD_19))) AS TOTAL19,
       (SUM(SUBTOTALA_20) + SUM(SUBTOTALB_20) - ABS(SUM(SUBTOTALC_20)) - ABS(SUM(SUBTOTALD_20))) AS TOTAL20,
       (SUM(SUBTOTALA_21) + SUM(SUBTOTALB_21) - ABS(SUM(SUBTOTALC_21)) - ABS(SUM(SUBTOTALD_21))) AS TOTAL21,
       (SUM(SUBTOTALA_22) + SUM(SUBTOTALB_22) - ABS(SUM(SUBTOTALC_22)) - ABS(SUM(SUBTOTALD_22))) AS TOTAL22,
       (SUM(SUBTOTALA_23) + SUM(SUBTOTALB_23) - ABS(SUM(SUBTOTALC_23)) - ABS(SUM(SUBTOTALD_23))) AS TOTAL23,
       (SUM(SUBTOTALA_24) + SUM(SUBTOTALB_24) - ABS(SUM(SUBTOTALC_24)) - ABS(SUM(SUBTOTALD_24))) AS TOTAL24,
       (SUM(SUBTOTALA_25) + SUM(SUBTOTALB_25) - ABS(SUM(SUBTOTALC_25)) - ABS(SUM(SUBTOTALD_25))) AS TOTAL25,
       (SUM(SUBTOTALA_26) + SUM(SUBTOTALB_26) - ABS(SUM(SUBTOTALC_26)) - ABS(SUM(SUBTOTALD_26))) AS TOTAL26,
       (SUM(SUBTOTALA_27) + SUM(SUBTOTALB_27) - ABS(SUM(SUBTOTALC_27)) - ABS(SUM(SUBTOTALD_27))) AS TOTAL27,
       (SUM(SUBTOTALA_28) + SUM(SUBTOTALB_28) - ABS(SUM(SUBTOTALC_28)) - ABS(SUM(SUBTOTALD_28))) AS TOTAL28,
       (SUM(SUBTOTALA_29) + SUM(SUBTOTALB_29) - ABS(SUM(SUBTOTALC_29)) - ABS(SUM(SUBTOTALD_29))) AS TOTAL29,
       (SUM(SUBTOTALA_30) + SUM(SUBTOTALB_30) - ABS(SUM(SUBTOTALC_30)) - ABS(SUM(SUBTOTALD_30))) AS TOTAL30,
       (SUM(SUBTOTALA_31) + SUM(SUBTOTALB_31) - ABS(SUM(SUBTOTALC_31)) - ABS(SUM(SUBTOTALD_31))) AS TOTAL31
FROM (
    SELECT
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS SUBTOTALA_1,
        0 AS SUBTOTALB_1,
        0 AS SUBTOTALC_1,
        0 AS SUBTOTALD_1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_2,
        0 AS SUBTOTALB_2,
        0 AS SUBTOTALC_2,
        0 AS SUBTOTALD_2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_3,
        0 AS SUBTOTALB_3,
        0 AS SUBTOTALC_3,
        0 AS SUBTOTALD_3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_4,
        0 AS SUBTOTALB_4,
        0 AS SUBTOTALC_4,
        0 AS SUBTOTALD_4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_5,
        0 AS SUBTOTALB_5,
        0 AS SUBTOTALC_5,
        0 AS SUBTOTALD_5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_6,
        0 AS SUBTOTALB_6,
        0 AS SUBTOTALC_6,
        0 AS SUBTOTALD_6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_7,
        0 AS SUBTOTALB_7,
        0 AS SUBTOTALC_7,
        0 AS SUBTOTALD_7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_8,
        0 AS SUBTOTALB_8,
        0 AS SUBTOTALC_8,
        0 AS SUBTOTALD_8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_9,
        0 AS SUBTOTALB_9,
        0 AS SUBTOTALC_9,
        0 AS SUBTOTALD_9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_10,
        0 AS SUBTOTALB_10,
        0 AS SUBTOTALC_10,
        0 AS SUBTOTALD_10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_11,
        0 AS SUBTOTALB_11,
        0 AS SUBTOTALC_11,
        0 AS SUBTOTALD_11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_12,
        0 AS SUBTOTALB_12,
        0 AS SUBTOTALC_12,
        0 AS SUBTOTALD_12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_13,
        0 AS SUBTOTALB_13,
        0 AS SUBTOTALC_13,
        0 AS SUBTOTALD_13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_14,
        0 AS SUBTOTALB_14,
        0 AS SUBTOTALC_14,
        0 AS SUBTOTALD_14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_15,
        0 AS SUBTOTALB_15,
        0 AS SUBTOTALC_15,
        0 AS SUBTOTALD_15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_16,
        0 AS SUBTOTALB_16,
        0 AS SUBTOTALC_16,
        0 AS SUBTOTALD_16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_17,
        0 AS SUBTOTALB_17,
        0 AS SUBTOTALC_17,
        0 AS SUBTOTALD_17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_18,
        0 AS SUBTOTALB_18,
        0 AS SUBTOTALC_18,
        0 AS SUBTOTALD_18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_19,
        0 AS SUBTOTALB_19,
        0 AS SUBTOTALC_19,
        0 AS SUBTOTALD_19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_20,
        0 AS SUBTOTALB_20,
        0 AS SUBTOTALC_20,
        0 AS SUBTOTALD_20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_21,
        0 AS SUBTOTALB_21,
        0 AS SUBTOTALC_21,
        0 AS SUBTOTALD_21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_22,
        0 AS SUBTOTALB_22,
        0 AS SUBTOTALC_22,
        0 AS SUBTOTALD_22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_23,
        0 AS SUBTOTALB_23,
        0 AS SUBTOTALC_23,
        0 AS SUBTOTALD_23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_24,
        0 AS SUBTOTALB_24,
        0 AS SUBTOTALC_24,
        0 AS SUBTOTALD_24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_25,
        0 AS SUBTOTALB_25,
        0 AS SUBTOTALC_25,
        0 AS SUBTOTALD_25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_26,
        0 AS SUBTOTALB_26,
        0 AS SUBTOTALC_26,
        0 AS SUBTOTALD_26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_27,
        0 AS SUBTOTALB_27,
        0 AS SUBTOTALC_27,
        0 AS SUBTOTALD_27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_28,
        0 AS SUBTOTALB_28,
        0 AS SUBTOTALC_28,
        0 AS SUBTOTALD_28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_29,
        0 AS SUBTOTALB_29,
        0 AS SUBTOTALC_29,
        0 AS SUBTOTALD_29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_30,
        0 AS SUBTOTALB_30,
        0 AS SUBTOTALC_30,
        0 AS SUBTOTALD_30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_31,
  0 AS SUBTOTALB_31,
        0 AS SUBTOTALC_31,
        0 AS SUBTOTALD_31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
DET.CODCONCEPTO_MOV IS NULL AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

    UNION ALL

    SELECT
        0 AS SUBTOTALA_1,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '01' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_1,
        0 AS SUBTOTALC_1,
        0 AS SUBTOTALD_1,
        0 AS SUBTOTALA_2,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '02' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_2,
        0 AS SUBTOTALC_2,
        0 AS SUBTOTALD_2,
        0 AS SUBTOTALA_3,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '03' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_3,
        0 AS SUBTOTALC_3,
        0 AS SUBTOTALD_3,
        0 AS SUBTOTALA_4,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '04' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_4,
        0 AS SUBTOTALC_4,
        0 AS SUBTOTALD_4,
        0 AS SUBTOTALA_5,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '05' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_5,
        0 AS SUBTOTALC_5,
        0 AS SUBTOTALD_5,
        0 AS SUBTOTALA_6,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '06' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_6,
        0 AS SUBTOTALC_6,
        0 AS SUBTOTALD_6,
        0 AS SUBTOTALA_7,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '07' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_7,
        0 AS SUBTOTALC_7,
        0 AS SUBTOTALD_7,
        0 AS SUBTOTALA_8,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '08' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_8,
        0 AS SUBTOTALC_8,
        0 AS SUBTOTALD_8,
        0 AS SUBTOTALA_9,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '09' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_9,
        0 AS SUBTOTALC_9,
        0 AS SUBTOTALD_9,
        0 AS SUBTOTALA_10,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '10' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_10,
        0 AS SUBTOTALC_10,
        0 AS SUBTOTALD_10,
        0 AS SUBTOTALA_11,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '11' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_11,
        0 AS SUBTOTALC_11,
        0 AS SUBTOTALD_11,
        0 AS SUBTOTALA_12,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '12' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_12,
        0 AS SUBTOTALC_12,
        0 AS SUBTOTALD_12,
        0 AS SUBTOTALA_13,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '13' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_13,
        0 AS SUBTOTALC_13,
        0 AS SUBTOTALD_13,
        0 AS SUBTOTALA_14,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '14' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_14,
        0 AS SUBTOTALC_14,
        0 AS SUBTOTALD_14,
        0 AS SUBTOTALA_15,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '15' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_15,
        0 AS SUBTOTALC_15,
        0 AS SUBTOTALD_15,
        0 AS SUBTOTALA_16,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '16' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_16,
        0 AS SUBTOTALC_16,
        0 AS SUBTOTALD_16,
        0 AS SUBTOTALA_17,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '17' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_17,
        0 AS SUBTOTALC_17,
        0 AS SUBTOTALD_17,
        0 AS SUBTOTALA_18,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '18' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_18,
        0 AS SUBTOTALC_18,
        0 AS SUBTOTALD_18,
        0 AS SUBTOTALA_19,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '19' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_19,
        0 AS SUBTOTALC_19,
        0 AS SUBTOTALD_19,
        0 AS SUBTOTALA_20,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '20' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_20,
        0 AS SUBTOTALC_20,
        0 AS SUBTOTALD_20,
        0 AS SUBTOTALA_21,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '21' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_21,
        0 AS SUBTOTALC_21,
        0 AS SUBTOTALD_21,
        0 AS SUBTOTALA_22,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '22' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_22,
        0 AS SUBTOTALC_22,
        0 AS SUBTOTALD_22,
        0 AS SUBTOTALA_23,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '23' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_23,
        0 AS SUBTOTALC_23,
        0 AS SUBTOTALD_23,
        0 AS SUBTOTALA_24,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '24' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_24,
        0 AS SUBTOTALC_24,
        0 AS SUBTOTALD_24,
        0 AS SUBTOTALA_25,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '25' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_25,
        0 AS SUBTOTALC_25,
        0 AS SUBTOTALD_25,
        0 AS SUBTOTALA_26,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '26' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_26,
        0 AS SUBTOTALC_26,
        0 AS SUBTOTALD_26,
        0 AS SUBTOTALA_27,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '27' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_27,
        0 AS SUBTOTALC_27,
        0 AS SUBTOTALD_27,
        0 AS SUBTOTALA_28,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '28' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_28,
        0 AS SUBTOTALC_28,
        0 AS SUBTOTALD_28,
        0 AS SUBTOTALA_29,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '29' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_29,
        0 AS SUBTOTALC_29,
        0 AS SUBTOTALD_29,
        0 AS SUBTOTALA_30,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '30' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_30,
        0 AS SUBTOTALC_30,
        0 AS SUBTOTALD_30,
        0 AS SUBTOTALA_31,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '31' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_31,
        0 AS SUBTOTALC_31,
        0 AS SUBTOTALD_31
    FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
(DET.CODCONCEPTO_MOV = '00' OR
	DET.CODCONCEPTO_MOV = '01' OR
	DET.CODCONCEPTO_MOV = '80') AND
	CAB.CODCAJA != '80' AND
	CAB.CODCAJA != '90' AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
0 AS SUBTOTALA_1,
0 AS SUBTOTALB_1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALC_1,
0 AS SUBTOTALD_1,
0 AS SUBTOTALA_2,
0 AS SUBTOTALB_2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_2,
0 AS SUBTOTALD_2,
0 AS SUBTOTALA_3,
0 AS SUBTOTALB_3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_3,
0 AS SUBTOTALD_3,
0 AS SUBTOTALA_4,
0 AS SUBTOTALB_4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_4,
0 AS SUBTOTALD_4,
0 AS SUBTOTALA_5,
0 AS SUBTOTALB_5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_5,
0 AS SUBTOTALD_5,
0 AS SUBTOTALA_6,
0 AS SUBTOTALB_6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_6,
0 AS SUBTOTALD_6,
0 AS SUBTOTALA_7,
0 AS SUBTOTALB_7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_7,
0 AS SUBTOTALD_7,
0 AS SUBTOTALA_8,
0 AS SUBTOTALB_8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_8,
0 AS SUBTOTALD_8,
0 AS SUBTOTALA_9,
0 AS SUBTOTALB_9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_9,
0 AS SUBTOTALD_9,
0 AS SUBTOTALA_10,
0 AS SUBTOTALB_10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_10,
0 AS SUBTOTALD_10,
0 AS SUBTOTALA_11,
0 AS SUBTOTALB_11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_11,
0 AS SUBTOTALD_11,
0 AS SUBTOTALA_12,
0 AS SUBTOTALB_12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_12,
0 AS SUBTOTALD_12,
0 AS SUBTOTALA_13,
0 AS SUBTOTALB_13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_13,
0 AS SUBTOTALD_13,
0 AS SUBTOTALA_14,
0 AS SUBTOTALB_14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_14,
0 AS SUBTOTALD_14,
0 AS SUBTOTALA_15,
0 AS SUBTOTALB_15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_15,
0 AS SUBTOTALD_15,
0 AS SUBTOTALA_16,
0 AS SUBTOTALB_16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_16,
0 AS SUBTOTALD_16,
0 AS SUBTOTALA_17,
0 AS SUBTOTALB_17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_17,
0 AS SUBTOTALD_17,
0 AS SUBTOTALA_18,
0 AS SUBTOTALB_18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_18,
0 AS SUBTOTALD_18,
0 AS SUBTOTALA_19,
0 AS SUBTOTALB_19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_19,
0 AS SUBTOTALD_19,
0 AS SUBTOTALA_20,
0 AS SUBTOTALB_20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_20,
0 AS SUBTOTALD_20,
0 AS SUBTOTALA_21,
0 AS SUBTOTALB_21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_21,
0 AS SUBTOTALD_21,
0 AS SUBTOTALA_22,
0 AS SUBTOTALB_22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_22,
0 AS SUBTOTALD_22,
0 AS SUBTOTALA_23,
0 AS SUBTOTALB_23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_23,
0 AS SUBTOTALD_23,
0 AS SUBTOTALA_24,
0 AS SUBTOTALB_24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_24,
0 AS SUBTOTALD_24,
0 AS SUBTOTALA_25,
0 AS SUBTOTALB_25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_25,
0 AS SUBTOTALD_25,
0 AS SUBTOTALA_26,
0 AS SUBTOTALB_26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_26,
0 AS SUBTOTALD_26,
0 AS SUBTOTALA_27,
0 AS SUBTOTALB_27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_27,
0 AS SUBTOTALD_27,
0 AS SUBTOTALA_28,
0 AS SUBTOTALB_28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_28,
0 AS SUBTOTALD_28,
0 AS SUBTOTALA_29,
0 AS SUBTOTALB_29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_29,
0 AS SUBTOTALD_29,
0 AS SUBTOTALA_30,
0 AS SUBTOTALB_30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_30,
0 AS SUBTOTALD_30,
0 AS SUBTOTALA_31,
0 AS SUBTOTALB_31,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_31,
0 AS SUBTOTALD_31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
(DET.CODCONCEPTO_MOV = '02' OR
	  DET.CODCONCEPTO_MOV = '03') AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
0 AS SUBTOTALA_1,
0 AS SUBTOTALB_1,
0 AS SUBTOTALC_1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_1,
0 AS SUBTOTALA_2,
0 AS SUBTOTALB_2,
0 AS SUBTOTALC_2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_2,
0 AS SUBTOTALA_3,
0 AS SUBTOTALB_3,
0 AS SUBTOTALC_3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_3,
0 AS SUBTOTALA_4,
0 AS SUBTOTALB_4,
0 AS SUBTOTALC_4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 4 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_4,
0 AS SUBTOTALA_5,
0 AS SUBTOTALB_5,
0 AS SUBTOTALC_5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_5,
0 AS SUBTOTALA_6,
0 AS SUBTOTALB_6,
0 AS SUBTOTALC_6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_6,
0 AS SUBTOTALA_7,
0 AS SUBTOTALB_7,
0 AS SUBTOTALC_7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_7,
0 AS SUBTOTALA_8,
0 AS SUBTOTALB_8,
0 AS SUBTOTALC_8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_8,
0 AS SUBTOTALA_9,
0 AS SUBTOTALB_9,
0 AS SUBTOTALC_9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_9,
0 AS SUBTOTALA_10,
0 AS SUBTOTALB_10,
0 AS SUBTOTALC_10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_10,
0 AS SUBTOTALA_11,
0 AS SUBTOTALB_11,
0 AS SUBTOTALC_11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_11,
0 AS SUBTOTALA_12,
0 AS SUBTOTALB_12,
0 AS SUBTOTALC_12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_12,
0 AS SUBTOTALA_13,
0 AS SUBTOTALB_13,
0 AS SUBTOTALC_13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_13,
0 AS SUBTOTALA_14,
0 AS SUBTOTALB_14,
0 AS SUBTOTALC_14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_14,
0 AS SUBTOTALA_15,
0 AS SUBTOTALB_15,
0 AS SUBTOTALC_15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_15,
0 AS SUBTOTALA_16,
0 AS SUBTOTALB_16,
0 AS SUBTOTALC_16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_16,
0 AS SUBTOTALA_17,
0 AS SUBTOTALB_17,
0 AS SUBTOTALC_17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_17,
0 AS SUBTOTALA_18,
0 AS SUBTOTALB_18,
0 AS SUBTOTALC_18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_18,
0 AS SUBTOTALA_19,
0 AS SUBTOTALB_19,
0 AS SUBTOTALC_19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_19,
0 AS SUBTOTALA_20,
0 AS SUBTOTALB_20,
0 AS SUBTOTALC_20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_20,
0 AS SUBTOTALA_21,
0 AS SUBTOTALB_21,
0 AS SUBTOTALC_21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_21,
0 AS SUBTOTALA_22,
0 AS SUBTOTALB_22,
0 AS SUBTOTALC_22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_22,
0 AS SUBTOTALA_23,
0 AS SUBTOTALB_23,
0 AS SUBTOTALC_23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_23,
0 AS SUBTOTALA_24,
0 AS SUBTOTALB_24,
0 AS SUBTOTALC_24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_24,
0 AS SUBTOTALA_25,
0 AS SUBTOTALB_25,
0 AS SUBTOTALC_25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_25,
0 AS SUBTOTALA_26,
0 AS SUBTOTALB_26,
0 AS SUBTOTALC_26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_26,
0 AS SUBTOTALA_27,
0 AS SUBTOTALB_27,
0 AS SUBTOTALC_27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_27,
0 AS SUBTOTALA_28,
0 AS SUBTOTALB_28,
0 AS SUBTOTALC_28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_28,
0 AS SUBTOTALA_29,
0 AS SUBTOTALB_29,
0 AS SUBTOTALC_29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_29,
0 AS SUBTOTALA_30,
0 AS SUBTOTALB_30,
0 AS SUBTOTALC_30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_30,
0 AS SUBTOTALA_31,
0 AS SUBTOTALB_31,
0 AS SUBTOTALC_31,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
CODCONCEPTO_MOV = '81' AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}) AS TOTAL_DIF_SOBRANTE)

UNION ALL

(SELECT 'TOTAL DIF FALTANTE' AS FILA,
       (SUM(SUBTOTALA_1) + SUM(SUBTOTALB_1) - ABS(SUM(SUBTOTALC_1)) - ABS(SUM(SUBTOTALD_1))) AS TOTAL1,
       (SUM(SUBTOTALA_2) + SUM(SUBTOTALB_2) - ABS(SUM(SUBTOTALC_2)) - ABS(SUM(SUBTOTALD_2))) AS TOTAL2,
       (SUM(SUBTOTALA_3) + SUM(SUBTOTALB_3) - ABS(SUM(SUBTOTALC_3)) - ABS(SUM(SUBTOTALD_3))) AS TOTAL3,
       (SUM(SUBTOTALA_4) + SUM(SUBTOTALB_4) - ABS(SUM(SUBTOTALC_4)) - ABS(SUM(SUBTOTALD_4))) AS TOTAL4,
       (SUM(SUBTOTALA_5) + SUM(SUBTOTALB_5) - ABS(SUM(SUBTOTALC_5)) - ABS(SUM(SUBTOTALD_5))) AS TOTAL5,
       (SUM(SUBTOTALA_6) + SUM(SUBTOTALB_6) - ABS(SUM(SUBTOTALC_6)) - ABS(SUM(SUBTOTALD_6))) AS TOTAL6,
       (SUM(SUBTOTALA_7) + SUM(SUBTOTALB_7) - ABS(SUM(SUBTOTALC_7)) - ABS(SUM(SUBTOTALD_7))) AS TOTAL7,
       (SUM(SUBTOTALA_8) + SUM(SUBTOTALB_8) - ABS(SUM(SUBTOTALC_8)) - ABS(SUM(SUBTOTALD_8))) AS TOTAL8,
       (SUM(SUBTOTALA_9) + SUM(SUBTOTALB_9) - ABS(SUM(SUBTOTALC_9)) - ABS(SUM(SUBTOTALD_9))) AS TOTAL9,
       (SUM(SUBTOTALA_10) + SUM(SUBTOTALB_10) - ABS(SUM(SUBTOTALC_10)) - ABS(SUM(SUBTOTALD_10))) AS TOTAL10,
       (SUM(SUBTOTALA_11) + SUM(SUBTOTALB_11) - ABS(SUM(SUBTOTALC_11)) - ABS(SUM(SUBTOTALD_11))) AS TOTAL11,
       (SUM(SUBTOTALA_12) + SUM(SUBTOTALB_12) - ABS(SUM(SUBTOTALC_12)) - ABS(SUM(SUBTOTALD_12))) AS TOTAL12,
       (SUM(SUBTOTALA_13) + SUM(SUBTOTALB_13) - ABS(SUM(SUBTOTALC_13)) - ABS(SUM(SUBTOTALD_13))) AS TOTAL13,
       (SUM(SUBTOTALA_14) + SUM(SUBTOTALB_14) - ABS(SUM(SUBTOTALC_14)) - ABS(SUM(SUBTOTALD_14))) AS TOTAL14,
       (SUM(SUBTOTALA_15) + SUM(SUBTOTALB_15) - ABS(SUM(SUBTOTALC_15)) - ABS(SUM(SUBTOTALD_15))) AS TOTAL15,
       (SUM(SUBTOTALA_16) + SUM(SUBTOTALB_16) - ABS(SUM(SUBTOTALC_16)) - ABS(SUM(SUBTOTALD_16))) AS TOTAL16,
       (SUM(SUBTOTALA_17) + SUM(SUBTOTALB_17) - ABS(SUM(SUBTOTALC_17)) - ABS(SUM(SUBTOTALD_17))) AS TOTAL17,
       (SUM(SUBTOTALA_18) + SUM(SUBTOTALB_18) - ABS(SUM(SUBTOTALC_18)) - ABS(SUM(SUBTOTALD_18))) AS TOTAL18,
       (SUM(SUBTOTALA_19) + SUM(SUBTOTALB_19) - ABS(SUM(SUBTOTALC_19)) - ABS(SUM(SUBTOTALD_19))) AS TOTAL19,
       (SUM(SUBTOTALA_20) + SUM(SUBTOTALB_20) - ABS(SUM(SUBTOTALC_20)) - ABS(SUM(SUBTOTALD_20))) AS TOTAL20,
       (SUM(SUBTOTALA_21) + SUM(SUBTOTALB_21) - ABS(SUM(SUBTOTALC_21)) - ABS(SUM(SUBTOTALD_21))) AS TOTAL21,
       (SUM(SUBTOTALA_22) + SUM(SUBTOTALB_22) - ABS(SUM(SUBTOTALC_22)) - ABS(SUM(SUBTOTALD_22))) AS TOTAL22,
       (SUM(SUBTOTALA_23) + SUM(SUBTOTALB_23) - ABS(SUM(SUBTOTALC_23)) - ABS(SUM(SUBTOTALD_23))) AS TOTAL23,
       (SUM(SUBTOTALA_24) + SUM(SUBTOTALB_24) - ABS(SUM(SUBTOTALC_24)) - ABS(SUM(SUBTOTALD_24))) AS TOTAL24,
       (SUM(SUBTOTALA_25) + SUM(SUBTOTALB_25) - ABS(SUM(SUBTOTALC_25)) - ABS(SUM(SUBTOTALD_25))) AS TOTAL25,
       (SUM(SUBTOTALA_26) + SUM(SUBTOTALB_26) - ABS(SUM(SUBTOTALC_26)) - ABS(SUM(SUBTOTALD_26))) AS TOTAL26,
       (SUM(SUBTOTALA_27) + SUM(SUBTOTALB_27) - ABS(SUM(SUBTOTALC_27)) - ABS(SUM(SUBTOTALD_27))) AS TOTAL27,
       (SUM(SUBTOTALA_28) + SUM(SUBTOTALB_28) - ABS(SUM(SUBTOTALC_28)) - ABS(SUM(SUBTOTALD_28))) AS TOTAL28,
       (SUM(SUBTOTALA_29) + SUM(SUBTOTALB_29) - ABS(SUM(SUBTOTALC_29)) - ABS(SUM(SUBTOTALD_29))) AS TOTAL29,
       (SUM(SUBTOTALA_30) + SUM(SUBTOTALB_30) - ABS(SUM(SUBTOTALC_30)) - ABS(SUM(SUBTOTALD_30))) AS TOTAL30,
       (SUM(SUBTOTALA_31) + SUM(SUBTOTALB_31) - ABS(SUM(SUBTOTALC_31)) - ABS(SUM(SUBTOTALD_31))) AS TOTAL31
FROM (
    SELECT
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS SUBTOTALA_1,
        0 AS SUBTOTALB_1,
        0 AS SUBTOTALC_1,
        0 AS SUBTOTALD_1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_2,
        0 AS SUBTOTALB_2,
        0 AS SUBTOTALC_2,
        0 AS SUBTOTALD_2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_3,
        0 AS SUBTOTALB_3,
        0 AS SUBTOTALC_3,
        0 AS SUBTOTALD_3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_4,
        0 AS SUBTOTALB_4,
        0 AS SUBTOTALC_4,
        0 AS SUBTOTALD_4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_5,
        0 AS SUBTOTALB_5,
        0 AS SUBTOTALC_5,
        0 AS SUBTOTALD_5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_6,
        0 AS SUBTOTALB_6,
        0 AS SUBTOTALC_6,
        0 AS SUBTOTALD_6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_7,
        0 AS SUBTOTALB_7,
        0 AS SUBTOTALC_7,
        0 AS SUBTOTALD_7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_8,
        0 AS SUBTOTALB_8,
        0 AS SUBTOTALC_8,
        0 AS SUBTOTALD_8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_9,
        0 AS SUBTOTALB_9,
        0 AS SUBTOTALC_9,
        0 AS SUBTOTALD_9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_10,
        0 AS SUBTOTALB_10,
        0 AS SUBTOTALC_10,
        0 AS SUBTOTALD_10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_11,
        0 AS SUBTOTALB_11,
        0 AS SUBTOTALC_11,
        0 AS SUBTOTALD_11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_12,
        0 AS SUBTOTALB_12,
        0 AS SUBTOTALC_12,
        0 AS SUBTOTALD_12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_13,
        0 AS SUBTOTALB_13,
        0 AS SUBTOTALC_13,
        0 AS SUBTOTALD_13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_14,
        0 AS SUBTOTALB_14,
        0 AS SUBTOTALC_14,
        0 AS SUBTOTALD_14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_15,
        0 AS SUBTOTALB_15,
        0 AS SUBTOTALC_15,
        0 AS SUBTOTALD_15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_16,
        0 AS SUBTOTALB_16,
        0 AS SUBTOTALC_16,
        0 AS SUBTOTALD_16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_17,
        0 AS SUBTOTALB_17,
        0 AS SUBTOTALC_17,
        0 AS SUBTOTALD_17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_18,
        0 AS SUBTOTALB_18,
        0 AS SUBTOTALC_18,
        0 AS SUBTOTALD_18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_19,
        0 AS SUBTOTALB_19,
        0 AS SUBTOTALC_19,
        0 AS SUBTOTALD_19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_20,
        0 AS SUBTOTALB_20,
        0 AS SUBTOTALC_20,
        0 AS SUBTOTALD_20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_21,
        0 AS SUBTOTALB_21,
        0 AS SUBTOTALC_21,
        0 AS SUBTOTALD_21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_22,
        0 AS SUBTOTALB_22,
        0 AS SUBTOTALC_22,
        0 AS SUBTOTALD_22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_23,
        0 AS SUBTOTALB_23,
        0 AS SUBTOTALC_23,
        0 AS SUBTOTALD_23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_24,
        0 AS SUBTOTALB_24,
        0 AS SUBTOTALC_24,
        0 AS SUBTOTALD_24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_25,
        0 AS SUBTOTALB_25,
        0 AS SUBTOTALC_25,
        0 AS SUBTOTALD_25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_26,
        0 AS SUBTOTALB_26,
        0 AS SUBTOTALC_26,
        0 AS SUBTOTALD_26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_27,
        0 AS SUBTOTALB_27,
        0 AS SUBTOTALC_27,
        0 AS SUBTOTALD_27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_28,
        0 AS SUBTOTALB_28,
        0 AS SUBTOTALC_28,
        0 AS SUBTOTALD_28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_29,
        0 AS SUBTOTALB_29,
        0 AS SUBTOTALC_29,
        0 AS SUBTOTALD_29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_30,
        0 AS SUBTOTALB_30,
        0 AS SUBTOTALC_30,
        0 AS SUBTOTALD_30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_31,
  0 AS SUBTOTALB_31,
        0 AS SUBTOTALC_31,
        0 AS SUBTOTALD_31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
DET.CODCONCEPTO_MOV IS NULL AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

    UNION ALL

    SELECT
        0 AS SUBTOTALA_1,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '01' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_1,
        0 AS SUBTOTALC_1,
        0 AS SUBTOTALD_1,
        0 AS SUBTOTALA_2,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '02' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_2,
        0 AS SUBTOTALC_2,
        0 AS SUBTOTALD_2,
        0 AS SUBTOTALA_3,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '03' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_3,
        0 AS SUBTOTALC_3,
        0 AS SUBTOTALD_3,
        0 AS SUBTOTALA_4,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '04' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_4,
        0 AS SUBTOTALC_4,
        0 AS SUBTOTALD_4,
        0 AS SUBTOTALA_5,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '05' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_5,
        0 AS SUBTOTALC_5,
        0 AS SUBTOTALD_5,
        0 AS SUBTOTALA_6,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '06' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_6,
        0 AS SUBTOTALC_6,
        0 AS SUBTOTALD_6,
        0 AS SUBTOTALA_7,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '07' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_7,
        0 AS SUBTOTALC_7,
        0 AS SUBTOTALD_7,
        0 AS SUBTOTALA_8,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '08' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_8,
        0 AS SUBTOTALC_8,
        0 AS SUBTOTALD_8,
        0 AS SUBTOTALA_9,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '09' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_9,
        0 AS SUBTOTALC_9,
        0 AS SUBTOTALD_9,
        0 AS SUBTOTALA_10,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '10' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_10,
        0 AS SUBTOTALC_10,
        0 AS SUBTOTALD_10,
        0 AS SUBTOTALA_11,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '11' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_11,
        0 AS SUBTOTALC_11,
        0 AS SUBTOTALD_11,
        0 AS SUBTOTALA_12,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '12' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_12,
        0 AS SUBTOTALC_12,
        0 AS SUBTOTALD_12,
        0 AS SUBTOTALA_13,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '13' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_13,
        0 AS SUBTOTALC_13,
        0 AS SUBTOTALD_13,
        0 AS SUBTOTALA_14,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '14' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_14,
        0 AS SUBTOTALC_14,
        0 AS SUBTOTALD_14,
        0 AS SUBTOTALA_15,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '15' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_15,
        0 AS SUBTOTALC_15,
        0 AS SUBTOTALD_15,
        0 AS SUBTOTALA_16,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '16' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_16,
        0 AS SUBTOTALC_16,
        0 AS SUBTOTALD_16,
        0 AS SUBTOTALA_17,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '17' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_17,
        0 AS SUBTOTALC_17,
        0 AS SUBTOTALD_17,
        0 AS SUBTOTALA_18,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '18' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_18,
        0 AS SUBTOTALC_18,
        0 AS SUBTOTALD_18,
        0 AS SUBTOTALA_19,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '19' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_19,
        0 AS SUBTOTALC_19,
        0 AS SUBTOTALD_19,
        0 AS SUBTOTALA_20,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '20' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_20,
        0 AS SUBTOTALC_20,
        0 AS SUBTOTALD_20,
        0 AS SUBTOTALA_21,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '21' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_21,
        0 AS SUBTOTALC_21,
        0 AS SUBTOTALD_21,
        0 AS SUBTOTALA_22,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '22' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_22,
        0 AS SUBTOTALC_22,
        0 AS SUBTOTALD_22,
        0 AS SUBTOTALA_23,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '23' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_23,
        0 AS SUBTOTALC_23,
        0 AS SUBTOTALD_23,
        0 AS SUBTOTALA_24,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '24' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_24,
        0 AS SUBTOTALC_24,
        0 AS SUBTOTALD_24,
        0 AS SUBTOTALA_25,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '25' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_25,
        0 AS SUBTOTALC_25,
        0 AS SUBTOTALD_25,
        0 AS SUBTOTALA_26,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '26' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_26,
        0 AS SUBTOTALC_26,
        0 AS SUBTOTALD_26,
        0 AS SUBTOTALA_27,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '27' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_27,
        0 AS SUBTOTALC_27,
        0 AS SUBTOTALD_27,
        0 AS SUBTOTALA_28,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '28' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_28,
        0 AS SUBTOTALC_28,
        0 AS SUBTOTALD_28,
        0 AS SUBTOTALA_29,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '29' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_29,
        0 AS SUBTOTALC_29,
        0 AS SUBTOTALD_29,
        0 AS SUBTOTALA_30,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '30' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_30,
        0 AS SUBTOTALC_30,
        0 AS SUBTOTALD_30,
        0 AS SUBTOTALA_31,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '31' THEN (DET.CARGO) ELSE 0 END
        ) AS SUBTOTALB_31,
        0 AS SUBTOTALC_31,
        0 AS SUBTOTALD_31
    FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
(DET.CODCONCEPTO_MOV = '00' OR
	DET.CODCONCEPTO_MOV = '01' OR
	DET.CODCONCEPTO_MOV = '80') AND
	CAB.CODCAJA != '80' AND
	CAB.CODCAJA != '90' AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
0 AS SUBTOTALA_1,
0 AS SUBTOTALB_1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALC_1,
0 AS SUBTOTALD_1,
0 AS SUBTOTALA_2,
0 AS SUBTOTALB_2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_2,
0 AS SUBTOTALD_2,
0 AS SUBTOTALA_3,
0 AS SUBTOTALB_3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_3,
0 AS SUBTOTALD_3,
0 AS SUBTOTALA_4,
0 AS SUBTOTALB_4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_4,
0 AS SUBTOTALD_4,
0 AS SUBTOTALA_5,
0 AS SUBTOTALB_5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_5,
0 AS SUBTOTALD_5,
0 AS SUBTOTALA_6,
0 AS SUBTOTALB_6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_6,
0 AS SUBTOTALD_6,
0 AS SUBTOTALA_7,
0 AS SUBTOTALB_7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_7,
0 AS SUBTOTALD_7,
0 AS SUBTOTALA_8,
0 AS SUBTOTALB_8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_8,
0 AS SUBTOTALD_8,
0 AS SUBTOTALA_9,
0 AS SUBTOTALB_9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_9,
0 AS SUBTOTALD_9,
0 AS SUBTOTALA_10,
0 AS SUBTOTALB_10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_10,
0 AS SUBTOTALD_10,
0 AS SUBTOTALA_11,
0 AS SUBTOTALB_11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_11,
0 AS SUBTOTALD_11,
0 AS SUBTOTALA_12,
0 AS SUBTOTALB_12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_12,
0 AS SUBTOTALD_12,
0 AS SUBTOTALA_13,
0 AS SUBTOTALB_13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_13,
0 AS SUBTOTALD_13,
0 AS SUBTOTALA_14,
0 AS SUBTOTALB_14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_14,
0 AS SUBTOTALD_14,
0 AS SUBTOTALA_15,
0 AS SUBTOTALB_15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_15,
0 AS SUBTOTALD_15,
0 AS SUBTOTALA_16,
0 AS SUBTOTALB_16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_16,
0 AS SUBTOTALD_16,
0 AS SUBTOTALA_17,
0 AS SUBTOTALB_17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_17,
0 AS SUBTOTALD_17,
0 AS SUBTOTALA_18,
0 AS SUBTOTALB_18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_18,
0 AS SUBTOTALD_18,
0 AS SUBTOTALA_19,
0 AS SUBTOTALB_19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_19,
0 AS SUBTOTALD_19,
0 AS SUBTOTALA_20,
0 AS SUBTOTALB_20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_20,
0 AS SUBTOTALD_20,
0 AS SUBTOTALA_21,
0 AS SUBTOTALB_21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_21,
0 AS SUBTOTALD_21,
0 AS SUBTOTALA_22,
0 AS SUBTOTALB_22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_22,
0 AS SUBTOTALD_22,
0 AS SUBTOTALA_23,
0 AS SUBTOTALB_23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_23,
0 AS SUBTOTALD_23,
0 AS SUBTOTALA_24,
0 AS SUBTOTALB_24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_24,
0 AS SUBTOTALD_24,
0 AS SUBTOTALA_25,
0 AS SUBTOTALB_25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_25,
0 AS SUBTOTALD_25,
0 AS SUBTOTALA_26,
0 AS SUBTOTALB_26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_26,
0 AS SUBTOTALD_26,
0 AS SUBTOTALA_27,
0 AS SUBTOTALB_27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_27,
0 AS SUBTOTALD_27,
0 AS SUBTOTALA_28,
0 AS SUBTOTALB_28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_28,
0 AS SUBTOTALD_28,
0 AS SUBTOTALA_29,
0 AS SUBTOTALB_29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_29,
0 AS SUBTOTALD_29,
0 AS SUBTOTALA_30,
0 AS SUBTOTALB_30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_30,
0 AS SUBTOTALD_30,
0 AS SUBTOTALA_31,
0 AS SUBTOTALB_31,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO) ELSE 0 END
) AS SUBTOTALC_31,
0 AS SUBTOTALD_31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
(DET.CODCONCEPTO_MOV = '02' OR
	  DET.CODCONCEPTO_MOV = '03') AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
0 AS SUBTOTALA_1,
0 AS SUBTOTALB_1,
0 AS SUBTOTALC_1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_1,
0 AS SUBTOTALA_2,
0 AS SUBTOTALB_2,
0 AS SUBTOTALC_2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_2,
0 AS SUBTOTALA_3,
0 AS SUBTOTALB_3,
0 AS SUBTOTALC_3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_3,
0 AS SUBTOTALA_4,
0 AS SUBTOTALB_4,
0 AS SUBTOTALC_4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 4 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_4,
0 AS SUBTOTALA_5,
0 AS SUBTOTALB_5,
0 AS SUBTOTALC_5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_5,
0 AS SUBTOTALA_6,
0 AS SUBTOTALB_6,
0 AS SUBTOTALC_6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_6,
0 AS SUBTOTALA_7,
0 AS SUBTOTALB_7,
0 AS SUBTOTALC_7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_7,
0 AS SUBTOTALA_8,
0 AS SUBTOTALB_8,
0 AS SUBTOTALC_8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_8,
0 AS SUBTOTALA_9,
0 AS SUBTOTALB_9,
0 AS SUBTOTALC_9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_9,
0 AS SUBTOTALA_10,
0 AS SUBTOTALB_10,
0 AS SUBTOTALC_10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_10,
0 AS SUBTOTALA_11,
0 AS SUBTOTALB_11,
0 AS SUBTOTALC_11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_11,
0 AS SUBTOTALA_12,
0 AS SUBTOTALB_12,
0 AS SUBTOTALC_12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_12,
0 AS SUBTOTALA_13,
0 AS SUBTOTALB_13,
0 AS SUBTOTALC_13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_13,
0 AS SUBTOTALA_14,
0 AS SUBTOTALB_14,
0 AS SUBTOTALC_14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_14,
0 AS SUBTOTALA_15,
0 AS SUBTOTALB_15,
0 AS SUBTOTALC_15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_15,
0 AS SUBTOTALA_16,
0 AS SUBTOTALB_16,
0 AS SUBTOTALC_16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_16,
0 AS SUBTOTALA_17,
0 AS SUBTOTALB_17,
0 AS SUBTOTALC_17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_17,
0 AS SUBTOTALA_18,
0 AS SUBTOTALB_18,
0 AS SUBTOTALC_18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_18,
0 AS SUBTOTALA_19,
0 AS SUBTOTALB_19,
0 AS SUBTOTALC_19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_19,
0 AS SUBTOTALA_20,
0 AS SUBTOTALB_20,
0 AS SUBTOTALC_20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_20,
0 AS SUBTOTALA_21,
0 AS SUBTOTALB_21,
0 AS SUBTOTALC_21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_21,
0 AS SUBTOTALA_22,
0 AS SUBTOTALB_22,
0 AS SUBTOTALC_22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_22,
0 AS SUBTOTALA_23,
0 AS SUBTOTALB_23,
0 AS SUBTOTALC_23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_23,
0 AS SUBTOTALA_24,
0 AS SUBTOTALB_24,
0 AS SUBTOTALC_24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_24,
0 AS SUBTOTALA_25,
0 AS SUBTOTALB_25,
0 AS SUBTOTALC_25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_25,
0 AS SUBTOTALA_26,
0 AS SUBTOTALB_26,
0 AS SUBTOTALC_26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_26,
0 AS SUBTOTALA_27,
0 AS SUBTOTALB_27,
0 AS SUBTOTALC_27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_27,
0 AS SUBTOTALA_28,
0 AS SUBTOTALB_28,
0 AS SUBTOTALC_28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_28,
0 AS SUBTOTALA_29,
0 AS SUBTOTALB_29,
0 AS SUBTOTALC_29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_29,
0 AS SUBTOTALA_30,
0 AS SUBTOTALB_30,
0 AS SUBTOTALC_30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_30,
0 AS SUBTOTALA_31,
0 AS SUBTOTALB_31,
0 AS SUBTOTALC_31,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO) ELSE 0 END
)AS SUBTOTALD_31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
CODCONCEPTO_MOV = '81' AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}) AS TOTAL_DIF_SOBRANTE)

UNION ALL

SELECT
'RETIRADAS DEL DIA' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
DET.CODCONCEPTO_MOV = 02 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
'RETIRADAS EN TIENDA' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
CAB.CODCAJA =90 AND DET.CODCONCEPTO_MOV = 90 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
'ENVIADO A BANCO' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
DET.CODCONCEPTO_MOV = 91 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
'IMPORTE INGRESADO EN BANCO' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
DET.CODCONCEPTO_MOV = 92 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

(SELECT 'DIFERENCIA RETIRADAS' AS FILA,
       (SUM(SUBTOTALA_1) - ABS(SUM(SUBTOTALB_1))) AS TOTAL1,
       (SUM(SUBTOTALA_2) - ABS(SUM(SUBTOTALB_2))) AS TOTAL2,
       (SUM(SUBTOTALA_3) - ABS(SUM(SUBTOTALB_3))) AS TOTAL3,
       (SUM(SUBTOTALA_4) - ABS(SUM(SUBTOTALB_4))) AS TOTAL4,
       (SUM(SUBTOTALA_5) - ABS(SUM(SUBTOTALB_5))) AS TOTAL5,
       (SUM(SUBTOTALA_6) - ABS(SUM(SUBTOTALB_6))) AS TOTAL6,
       (SUM(SUBTOTALA_7) - ABS(SUM(SUBTOTALB_7))) AS TOTAL7,
       (SUM(SUBTOTALA_8) - ABS(SUM(SUBTOTALB_8))) AS TOTAL8,
       (SUM(SUBTOTALA_9) - ABS(SUM(SUBTOTALB_9))) AS TOTAL9,
       (SUM(SUBTOTALA_10) - ABS(SUM(SUBTOTALB_10))) AS TOTAL10,
       (SUM(SUBTOTALA_11) - ABS(SUM(SUBTOTALB_11))) AS TOTAL11,
       (SUM(SUBTOTALA_12) - ABS(SUM(SUBTOTALB_12))) AS TOTAL12,
       (SUM(SUBTOTALA_13) - ABS(SUM(SUBTOTALB_13))) AS TOTAL13,
       (SUM(SUBTOTALA_14) - ABS(SUM(SUBTOTALB_14))) AS TOTAL14,
       (SUM(SUBTOTALA_15) - ABS(SUM(SUBTOTALB_15))) AS TOTAL15,
       (SUM(SUBTOTALA_16) - ABS(SUM(SUBTOTALB_16))) AS TOTAL16,
       (SUM(SUBTOTALA_17) - ABS(SUM(SUBTOTALB_17))) AS TOTAL17,
       (SUM(SUBTOTALA_18) - ABS(SUM(SUBTOTALB_18))) AS TOTAL18,
       (SUM(SUBTOTALA_19) - ABS(SUM(SUBTOTALB_19))) AS TOTAL19,
       (SUM(SUBTOTALA_20) - ABS(SUM(SUBTOTALB_20))) AS TOTAL20,
       (SUM(SUBTOTALA_21) - ABS(SUM(SUBTOTALB_21))) AS TOTAL21,
       (SUM(SUBTOTALA_22) - ABS(SUM(SUBTOTALB_22))) AS TOTAL22,
       (SUM(SUBTOTALA_23) - ABS(SUM(SUBTOTALB_23))) AS TOTAL23,
       (SUM(SUBTOTALA_24) - ABS(SUM(SUBTOTALB_24))) AS TOTAL24,
       (SUM(SUBTOTALA_25) - ABS(SUM(SUBTOTALB_25))) AS TOTAL25,
       (SUM(SUBTOTALA_26) - ABS(SUM(SUBTOTALB_26))) AS TOTAL26,
       (SUM(SUBTOTALA_27) - ABS(SUM(SUBTOTALB_27))) AS TOTAL27,
       (SUM(SUBTOTALA_28) - ABS(SUM(SUBTOTALB_28))) AS TOTAL28,
       (SUM(SUBTOTALA_29) - ABS(SUM(SUBTOTALB_29))) AS TOTAL29,
       (SUM(SUBTOTALA_30) - ABS(SUM(SUBTOTALB_30))) AS TOTAL30,
       (SUM(SUBTOTALA_31) - ABS(SUM(SUBTOTALB_31))) AS TOTAL31
FROM (
    SELECT
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS SUBTOTALA_1,
        0 AS SUBTOTALB_1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_2,
        0 AS SUBTOTALB_2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_3,
        0 AS SUBTOTALB_3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_4,
        0 AS SUBTOTALB_4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_5,
        0 AS SUBTOTALB_5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_6,
        0 AS SUBTOTALB_6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_7,
        0 AS SUBTOTALB_7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_8,
        0 AS SUBTOTALB_8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_9,
        0 AS SUBTOTALB_9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_10,
        0 AS SUBTOTALB_10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_11,
        0 AS SUBTOTALB_11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_12,
        0 AS SUBTOTALB_12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_13,
        0 AS SUBTOTALB_13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_14,
        0 AS SUBTOTALB_14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_15,
        0 AS SUBTOTALB_15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_16,
        0 AS SUBTOTALB_16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_17,
        0 AS SUBTOTALB_17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_18,
        0 AS SUBTOTALB_18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_19,
        0 AS SUBTOTALB_19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_20,
        0 AS SUBTOTALB_20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_21,
        0 AS SUBTOTALB_21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_22,
        0 AS SUBTOTALB_22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_23,
        0 AS SUBTOTALB_23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_24,
        0 AS SUBTOTALB_24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_25,
        0 AS SUBTOTALB_25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_26,
        0 AS SUBTOTALB_26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_27,
        0 AS SUBTOTALB_27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_28,
        0 AS SUBTOTALB_28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_29,
        0 AS SUBTOTALB_29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_30,
        0 AS SUBTOTALB_30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_31,
  0 AS SUBTOTALB_31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
DET.CODCONCEPTO_MOV = 91 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

    UNION ALL

    SELECT
        0 AS SUBTOTALA_1,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '01' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_1,
        0 AS SUBTOTALA_2,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '02' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_2,
        0 AS SUBTOTALA_3,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '03' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_3,
        0 AS SUBTOTALA_4,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '04' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_4,
        0 AS SUBTOTALA_5,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '05' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_5,
        0 AS SUBTOTALA_6,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '06' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_6,
        0 AS SUBTOTALA_7,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '07' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_7,
        0 AS SUBTOTALA_8,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '08' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_8,
        0 AS SUBTOTALA_9,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '09' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_9,
        0 AS SUBTOTALA_10,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '10' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_10,
        0 AS SUBTOTALA_11,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '11' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_11,
        0 AS SUBTOTALA_12,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '12' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_12,
        0 AS SUBTOTALA_13,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '13' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_13,
        0 AS SUBTOTALA_14,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '14' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_14,
        0 AS SUBTOTALA_15,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '15' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_15,
        0 AS SUBTOTALA_16,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '16' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_16,
        0 AS SUBTOTALA_17,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '17' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_17,
        0 AS SUBTOTALA_18,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '18' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_18,
        0 AS SUBTOTALA_19,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '19' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_19,
        0 AS SUBTOTALA_20,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '20' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_20,
        0 AS SUBTOTALA_21,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '21' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_21,
        0 AS SUBTOTALA_22,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '22' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_22,
        0 AS SUBTOTALA_23,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '23' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_23,
        0 AS SUBTOTALA_24,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '24' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_24,
        0 AS SUBTOTALA_25,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '25' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_25,
        0 AS SUBTOTALA_26,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '26' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_26,
        0 AS SUBTOTALA_27,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '27' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_27,
        0 AS SUBTOTALA_28,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '28' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_28,
        0 AS SUBTOTALA_29,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '29' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_29,
        0 AS SUBTOTALA_30,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '30' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_30,
        0 AS SUBTOTALA_31,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '31' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_31
    FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
DET.CODCONCEPTO_MOV = 92 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}) AS DIFERENCIA_RETIRADAS)


UNION ALL

SELECT
'S.I. COFRE' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
CAB.CODCAJA =80 and DET.CODCONCEPTO_MOV = 00 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL
SELECT
'APORTACIONES' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
	DET.CODCONCEPTO_MOV = 01 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
'DESAPORTACIONES' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
	DET.CODCONCEPTO_MOV = 81 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

(SELECT 'CAMBIOS' AS FILA,
       (SUM(SUBTOTALA_1) - ABS(SUM(SUBTOTALB_1))) AS TOTAL1,
       (SUM(SUBTOTALA_2) - ABS(SUM(SUBTOTALB_2))) AS TOTAL2,
       (SUM(SUBTOTALA_3) - ABS(SUM(SUBTOTALB_3))) AS TOTAL3,
       (SUM(SUBTOTALA_4) - ABS(SUM(SUBTOTALB_4))) AS TOTAL4,
       (SUM(SUBTOTALA_5) - ABS(SUM(SUBTOTALB_5))) AS TOTAL5,
       (SUM(SUBTOTALA_6) - ABS(SUM(SUBTOTALB_6))) AS TOTAL6,
       (SUM(SUBTOTALA_7) - ABS(SUM(SUBTOTALB_7))) AS TOTAL7,
       (SUM(SUBTOTALA_8) - ABS(SUM(SUBTOTALB_8))) AS TOTAL8,
       (SUM(SUBTOTALA_9) - ABS(SUM(SUBTOTALB_9))) AS TOTAL9,
       (SUM(SUBTOTALA_10) - ABS(SUM(SUBTOTALB_10))) AS TOTAL10,
       (SUM(SUBTOTALA_11) - ABS(SUM(SUBTOTALB_11))) AS TOTAL11,
       (SUM(SUBTOTALA_12) - ABS(SUM(SUBTOTALB_12))) AS TOTAL12,
       (SUM(SUBTOTALA_13) - ABS(SUM(SUBTOTALB_13))) AS TOTAL13,
       (SUM(SUBTOTALA_14) - ABS(SUM(SUBTOTALB_14))) AS TOTAL14,
       (SUM(SUBTOTALA_15) - ABS(SUM(SUBTOTALB_15))) AS TOTAL15,
       (SUM(SUBTOTALA_16) - ABS(SUM(SUBTOTALB_16))) AS TOTAL16,
       (SUM(SUBTOTALA_17) - ABS(SUM(SUBTOTALB_17))) AS TOTAL17,
       (SUM(SUBTOTALA_18) - ABS(SUM(SUBTOTALB_18))) AS TOTAL18,
       (SUM(SUBTOTALA_19) - ABS(SUM(SUBTOTALB_19))) AS TOTAL19,
       (SUM(SUBTOTALA_20) - ABS(SUM(SUBTOTALB_20))) AS TOTAL20,
       (SUM(SUBTOTALA_21) - ABS(SUM(SUBTOTALB_21))) AS TOTAL21,
       (SUM(SUBTOTALA_22) - ABS(SUM(SUBTOTALB_22))) AS TOTAL22,
       (SUM(SUBTOTALA_23) - ABS(SUM(SUBTOTALB_23))) AS TOTAL23,
       (SUM(SUBTOTALA_24) - ABS(SUM(SUBTOTALB_24))) AS TOTAL24,
       (SUM(SUBTOTALA_25) - ABS(SUM(SUBTOTALB_25))) AS TOTAL25,
       (SUM(SUBTOTALA_26) - ABS(SUM(SUBTOTALB_26))) AS TOTAL26,
       (SUM(SUBTOTALA_27) - ABS(SUM(SUBTOTALB_27))) AS TOTAL27,
       (SUM(SUBTOTALA_28) - ABS(SUM(SUBTOTALB_28))) AS TOTAL28,
       (SUM(SUBTOTALA_29) - ABS(SUM(SUBTOTALB_29))) AS TOTAL29,
       (SUM(SUBTOTALA_30) - ABS(SUM(SUBTOTALB_30))) AS TOTAL30,
       (SUM(SUBTOTALA_31) - ABS(SUM(SUBTOTALB_31))) AS TOTAL31
FROM (
    SELECT
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS SUBTOTALA_1,
        0 AS SUBTOTALB_1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_2,
        0 AS SUBTOTALB_2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_3,
        0 AS SUBTOTALB_3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_4,
        0 AS SUBTOTALB_4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_5,
        0 AS SUBTOTALB_5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_6,
        0 AS SUBTOTALB_6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_7,
        0 AS SUBTOTALB_7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_8,
        0 AS SUBTOTALB_8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_9,
        0 AS SUBTOTALB_9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_10,
        0 AS SUBTOTALB_10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_11,
        0 AS SUBTOTALB_11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_12,
        0 AS SUBTOTALB_12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_13,
        0 AS SUBTOTALB_13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_14,
        0 AS SUBTOTALB_14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_15,
        0 AS SUBTOTALB_15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_16,
        0 AS SUBTOTALB_16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_17,
        0 AS SUBTOTALB_17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_18,
        0 AS SUBTOTALB_18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_19,
        0 AS SUBTOTALB_19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_20,
        0 AS SUBTOTALB_20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_21,
        0 AS SUBTOTALB_21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_22,
        0 AS SUBTOTALB_22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_23,
        0 AS SUBTOTALB_23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_24,
        0 AS SUBTOTALB_24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_25,
        0 AS SUBTOTALB_25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_26,
        0 AS SUBTOTALB_26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_27,
        0 AS SUBTOTALB_27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_28,
        0 AS SUBTOTALB_28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_29,
        0 AS SUBTOTALB_29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_30,
        0 AS SUBTOTALB_30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS SUBTOTALA_31,
  0 AS SUBTOTALB_31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
DET.CODCONCEPTO_MOV = 80 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

    UNION ALL

    SELECT
        0 AS SUBTOTALA_1,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '01' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_1,
        0 AS SUBTOTALA_2,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '02' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_2,
        0 AS SUBTOTALA_3,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '03' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_3,
        0 AS SUBTOTALA_4,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '04' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_4,
        0 AS SUBTOTALA_5,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '05' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_5,
        0 AS SUBTOTALA_6,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '06' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_6,
        0 AS SUBTOTALA_7,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '07' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_7,
        0 AS SUBTOTALA_8,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '08' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_8,
        0 AS SUBTOTALA_9,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '09' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_9,
        0 AS SUBTOTALA_10,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '10' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_10,
        0 AS SUBTOTALA_11,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '11' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_11,
        0 AS SUBTOTALA_12,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '12' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_12,
        0 AS SUBTOTALA_13,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '13' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_13,
        0 AS SUBTOTALA_14,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '14' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_14,
        0 AS SUBTOTALA_15,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '15' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_15,
        0 AS SUBTOTALA_16,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '16' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_16,
        0 AS SUBTOTALA_17,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '17' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_17,
        0 AS SUBTOTALA_18,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '18' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_18,
        0 AS SUBTOTALA_19,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '19' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_19,
        0 AS SUBTOTALA_20,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '20' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_20,
        0 AS SUBTOTALA_21,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '21' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_21,
        0 AS SUBTOTALA_22,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '22' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_22,
        0 AS SUBTOTALA_23,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '23' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_23,
        0 AS SUBTOTALA_24,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '24' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_24,
        0 AS SUBTOTALA_25,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '25' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_25,
        0 AS SUBTOTALA_26,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '26' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_26,
        0 AS SUBTOTALA_27,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '27' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_27,
        0 AS SUBTOTALA_28,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '28' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_28,
        0 AS SUBTOTALA_29,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '29' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_29,
        0 AS SUBTOTALA_30,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '30' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_30,
        0 AS SUBTOTALA_31,
        SUM(
            CASE WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = '31' THEN (DET.CARGO - DET.ABONO) ELSE 0 END
        ) AS SUBTOTALB_31
    FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
DET.CODCONCEPTO_MOV = 83 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}) AS CAMBIOS)


UNION ALL

SELECT
'COMPRA DE MONEDA' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
	DET.CODCONCEPTO_MOV = 82 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}

UNION ALL

SELECT
'S.F. COFRE 26010800' AS FILA,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 01 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
)AS TOTAL1,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 02 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL2,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 03 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL3,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 04 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL4,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 05 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL5,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 06 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL6,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 07 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL7,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 08 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL8,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 09 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL9,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 10 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL10,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 11 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL11,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 12 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL12,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 13 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL13,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 14 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL14,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 15 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL15,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 16 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL16,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 17 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL17,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 18 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL18,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 19 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL19,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 20 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL20,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 21 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL21,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 22 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL22,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 23 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL23,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 24 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL24,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 25 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL25,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 26 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL26,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 27 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL27,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 28 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL28,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 29 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL29,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 30 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL30,
SUM(CASE
  WHEN LPAD(DAYOFMONTH(DET.FECHA), 2, '0') = 31 THEN (DET.CARGO - DET.ABONO) ELSE 0 END
) AS TOTAL31
FROM
	D_CAJA_CAB_TBL CAB INNER JOIN
	D_CAJA_DET_TBL DET ON (DET.UID_ACTIVIDAD = CAB.UID_ACTIVIDAD AND
						   DET.UID_DIARIO_CAJA = CAB.UID_DIARIO_CAJA)
WHERE
CAB.CODCAJA =80 AND
DET.FECHA >= $P{FECHA_DESDE} AND
DET.FECHA <= $P{FECHA_HASTA} AND
CAB.CODALM >= $P{CODALM_DESDE} AND
CAB.CODALM <= $P{CODALM_HASTA} AND
CAB.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}) A]]>
	</queryString>
	<field name="FILA" class="java.lang.String"/>
	<field name="TOTAL1" class="java.lang.Double"/>
	<field name="TOTAL2" class="java.lang.Double"/>
	<field name="TOTAL3" class="java.lang.Double"/>
	<field name="TOTAL4" class="java.lang.Double"/>
	<field name="TOTAL5" class="java.lang.Double"/>
	<field name="TOTAL6" class="java.lang.Double"/>
	<field name="TOTAL7" class="java.lang.Double"/>
	<field name="TOTAL8" class="java.lang.Double"/>
	<field name="TOTAL9" class="java.lang.Double"/>
	<field name="TOTAL10" class="java.lang.Double"/>
	<field name="TOTAL11" class="java.lang.Double"/>
	<field name="TOTAL12" class="java.lang.Double"/>
	<field name="TOTAL13" class="java.lang.Double"/>
	<field name="TOTAL14" class="java.lang.Double"/>
	<field name="TOTAL15" class="java.lang.Double"/>
	<field name="TOTAL16" class="java.lang.Double"/>
	<field name="TOTAL17" class="java.lang.Double"/>
	<field name="TOTAL18" class="java.lang.Double"/>
	<field name="TOTAL19" class="java.lang.Double"/>
	<field name="TOTAL20" class="java.lang.Double"/>
	<field name="TOTAL21" class="java.lang.Double"/>
	<field name="TOTAL22" class="java.lang.Double"/>
	<field name="TOTAL23" class="java.lang.Double"/>
	<field name="TOTAL24" class="java.lang.Double"/>
	<field name="TOTAL25" class="java.lang.Double"/>
	<field name="TOTAL26" class="java.lang.Double"/>
	<field name="TOTAL27" class="java.lang.Double"/>
	<field name="TOTAL28" class="java.lang.Double"/>
	<field name="TOTAL29" class="java.lang.Double"/>
	<field name="TOTAL30" class="java.lang.Double"/>
	<field name="TOTAL31" class="java.lang.Double"/>
	<field name="TOTAL" class="java.lang.Double"/>
	<variable name="DIFERENCIA_DIA1" class="java.math.BigDecimal"/>
	<variable name="SUMA_TOTAL1" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL1}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL2" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL2}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL3" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL3}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL4" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL4}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL5" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL5}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL6" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL6}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL7" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL7}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL8" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL8}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL9" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL9}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL10" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL10}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL11" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL11}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL12" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL12}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL13" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL13}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL14" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL14}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL15" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL15}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL16" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL16}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL17" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL17}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL18" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL18}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL19" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL19}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL20" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL20}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL21" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL21}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL22" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL22}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL23" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL23}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL24" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL24}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL25" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL25}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL26" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL26}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL27" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL27}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL28" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL28}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL29" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL29}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL30" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL30}]]></variableExpression>
	</variable>
	<variable name="SUMA_TOTAL31" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL31}]]></variableExpression>
	</variable>
	<group name="GR_FILA" keepTogether="true">
		<groupExpression><![CDATA[$F{FILA}]]></groupExpression>
	</group>
	<columnHeader>
		<band height="20" splitType="Stretch">
			<rectangle>
				<reportElement uuid="525cebc1-317d-443d-b7bb-8a3826b2c2df" x="26" y="0" width="1951" height="20" backcolor="#999999"/>
				<graphicElement>
					<pen lineWidth="0.0"/>
				</graphicElement>
			</rectangle>
			<staticText>
				<reportElement uuid="bd6c27ab-bd54-4528-b2ca-29a1638e7f45" x="26" y="0" width="148" height="20" forecolor="#FFFFFF"/>
				<box leftPadding="3"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<text><![CDATA[FECHA]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="0e48cf86-59a9-4a6e-8bb8-d7bc409f8acc" mode="Transparent" x="255" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[1 de]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="1792" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[30 de]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="8b3ee49e-5915-4cd0-85a8-27f345ec2171" mode="Transparent" x="1898" y="0" width="79" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[TOTAL]]></text>
			</staticText>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="272" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="1809" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="1756" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="1739" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[29 de]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="1686" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[28 de]]></text>
			</staticText>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="1703" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="1633" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[27 de]]></text>
			</staticText>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="1650" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="1580" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[26 de]]></text>
			</staticText>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="1597" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="1544" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="1527" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[25 de]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="1474" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[24 de]]></text>
			</staticText>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="1491" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="1421" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[23 de]]></text>
			</staticText>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="1438" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="1368" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[22 de]]></text>
			</staticText>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="1385" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="1315" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[21 de]]></text>
			</staticText>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="1332" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="1279" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="1262" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[20 de]]></text>
			</staticText>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="1226" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="1209" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[19 de]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="1156" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[18 de]]></text>
			</staticText>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="1173" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="1103" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[17 de]]></text>
			</staticText>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="1120" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="1050" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[16 de]]></text>
			</staticText>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="1067" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="997" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[15 de]]></text>
			</staticText>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="1014" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="961" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="944" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[14 de]]></text>
			</staticText>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="908" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="891" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[13 de]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="838" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[12 de]]></text>
			</staticText>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="855" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="785" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[11 de]]></text>
			</staticText>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="802" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="749" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="732" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[10 de]]></text>
			</staticText>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="696" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="679" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[9 de]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="626" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[8 de]]></text>
			</staticText>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="643" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="573" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[7 de]]></text>
			</staticText>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="590" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="537" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="520" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[6 de]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="467" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[5 de]]></text>
			</staticText>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="484" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="431" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="414" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[4 de]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="361" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[3 de]]></text>
			</staticText>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="378" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="308" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[2 de]]></text>
			</staticText>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="325" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<textField pattern="MMMMM">
				<reportElement uuid="5105f8c7-e2d7-4c9c-a839-a501b399d3e0" x="1862" y="0" width="36" height="20" forecolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="061d69b6-90c2-43f9-b34b-83a9e63ab93d" mode="Transparent" x="1845" y="0" width="17" height="20" forecolor="#FFFFFF" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[31 de]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="aa67716c-a1f5-4b79-b09c-0e8d828103ff" mode="Opaque" x="0" y="0" width="26" height="20" backcolor="#999999"/>
				<textElement/>
				<text><![CDATA[]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="20" splitType="Stretch">
			<textField isBlankWhenNull="true">
				<reportElement uuid="7a61f6a0-17d7-4ba1-854e-a0bf6a4b4528" mode="Transparent" x="26" y="0" width="148" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<box leftPadding="3"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement uuid="19db4d40-e09e-4d9b-a231-8084c5e265cd" x="255" y="0" width="53" height="20"/>
				<textElement>
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL1} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL1} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL1} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL1} <= 0) ? 0 :  $F{TOTAL1}
) : $F{TOTAL1}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="fb03e8a2-7f02-430e-9e12-d4e70daccc5b" mode="Transparent" x="308" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL2} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL2} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL2} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL2} <= 0) ? 0 :  $F{TOTAL2}
) : $F{TOTAL2}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="fad91c83-a56c-4f5d-a9a0-c32fe168e55d" mode="Transparent" x="361" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL3} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL3} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL3} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL3} <= 0) ? 0 :  $F{TOTAL3}
) : $F{TOTAL3}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="1bb6a8e5-58d0-4cea-bfc3-d5b36ebf71e9" mode="Transparent" x="414" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL4} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL4} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL4} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL4} <= 0) ? 0 :  $F{TOTAL4}
) : $F{TOTAL4}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="23d2522d-671f-48df-b5be-a4d1985d1212" mode="Transparent" x="467" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL5} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL5} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL5} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL5} <= 0) ? 0 :  $F{TOTAL4}
) : $F{TOTAL5}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="76c3636d-ac95-441e-a267-125584a6c162" mode="Transparent" x="520" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL6} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL6} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL6} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL6} <= 0) ? 0 :  $F{TOTAL6}
) : $F{TOTAL6}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="44623dac-ec98-48f7-982b-7c5d0eff517a" mode="Transparent" x="573" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL7} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL7} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL7} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL7} <= 0) ? 0 :  $F{TOTAL7}
) : $F{TOTAL7}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="fc29fcb1-d5db-443a-89c8-2deebeaf82ae" mode="Transparent" x="626" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL8} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL8} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL8} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL8} <= 0) ? 0 :  $F{TOTAL8}
) : $F{TOTAL8}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="307428fa-bf91-4e7a-9fd0-f1300859e888" mode="Transparent" x="679" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL9} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL9} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL9} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL9} <= 0) ? 0 :  $F{TOTAL9}
) : $F{TOTAL9}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="dbf6bc9b-16cf-4a26-8e9b-2c80f3ed1928" mode="Transparent" x="732" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL10} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL10} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL10} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL10} <= 0) ? 0 :  $F{TOTAL10}
) : $F{TOTAL10}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="391b2ce3-134e-4539-8e4b-4f311f8a3d32" mode="Transparent" x="785" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL11} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL11} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL11} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL11} <= 0) ? 0 :  $F{TOTAL11}
) : $F{TOTAL11}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="a8e8bac9-b37c-4199-b67e-d858c45d9124" mode="Transparent" x="838" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL12} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL12} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL12} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL12} <= 0) ? 0 :  $F{TOTAL12}
) : $F{TOTAL12}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="6c2e45d0-e9b1-427d-8bcf-c7f9fc022863" mode="Transparent" x="891" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL13} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL13} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL13} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL13} <= 0) ? 0 :  $F{TOTAL13}
) : $F{TOTAL13}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="e9554bdb-8c46-429a-9c6a-8f50c067c9ca" mode="Transparent" x="944" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL14} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL14} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL14} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL14} <= 0) ? 0 :  $F{TOTAL14}
) : $F{TOTAL14}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="33e34a89-545f-47f8-a902-64eb68177f66" mode="Transparent" x="997" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL15} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL15} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL15} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL15} <= 0) ? 0 :  $F{TOTAL15}
) : $F{TOTAL15}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="371281d9-f025-464a-868e-bf5dace23089" mode="Transparent" x="1050" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL16} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL16} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL16} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL16} <= 0) ? 0 :  $F{TOTAL16}
) : $F{TOTAL16}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="77124612-7e6b-4184-b84f-19a9f4477ae6" mode="Transparent" x="1103" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL17} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL17} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL17} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL17} <= 0) ? 0 :  $F{TOTAL17}
) : $F{TOTAL17}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="b4760e67-c0f3-4630-a846-1e140fee5548" mode="Transparent" x="1156" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL18} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL18} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL18} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL18} <= 0) ? 0 :  $F{TOTAL18}
) : $F{TOTAL18}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="d39a5153-c634-42e6-92ff-12e5cc9d133a" mode="Transparent" x="1209" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL19} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL19} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL19} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL19} <= 0) ? 0 :  $F{TOTAL19}
) : $F{TOTAL19}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="1b6ee87d-f57b-4471-a574-b3af9a633558" mode="Transparent" x="1262" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL20} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL20} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL20} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL20} <= 0) ? 0 :  $F{TOTAL20}
) : $F{TOTAL20}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="87f1d344-5a2b-4bbe-b12e-b7dfc2cad59b" mode="Transparent" x="1315" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL21} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL21} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL21} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL21} <= 0) ? 0 :  $F{TOTAL21}
) : $F{TOTAL21}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="1c1655bc-0260-44da-a3f6-5477adfd933f" mode="Transparent" x="1368" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL22} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL22} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL22} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL22} <= 0) ? 0 :  $F{TOTAL22}
) : $F{TOTAL22}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="3fb55e2a-49ba-4430-b0ba-c653e6668436" mode="Transparent" x="1421" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL23} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL23} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL23} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL23} <= 0) ? 0 :  $F{TOTAL23}
) : $F{TOTAL23}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="d22cabbd-742d-43bb-a53a-24591e82b6b8" mode="Transparent" x="1474" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL24} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL24} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL24} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL24} <= 0) ? 0 :  $F{TOTAL24}
) : $F{TOTAL24}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="34f54e0c-6238-4f3d-9895-ad417bbaeba4" mode="Transparent" x="1527" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL25} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL25} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL25} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL25} <= 0) ? 0 :  $F{TOTAL25}
) : $F{TOTAL25}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="96076b9e-659d-45b0-a076-8c83e5fd82a3" mode="Transparent" x="1580" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL26} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL26} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL26} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL26} <= 0) ? 0 :  $F{TOTAL2}
) : $F{TOTAL26}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="93c6ea81-667c-44b4-ab42-af08dfe4d08b" mode="Transparent" x="1633" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL27} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL27} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL27} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL27} <= 0) ? 0 :  $F{TOTAL27}
) : $F{TOTAL27}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="1551c52f-3c6b-4853-befa-7277cd39ef4d" mode="Transparent" x="1686" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL28} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL28} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL28} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL28} <= 0) ? 0 :  $F{TOTAL28}
) : $F{TOTAL28}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="647a53dc-6be9-41d5-8f77-a9c6a6ceded3" mode="Transparent" x="1739" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL29} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL29} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL29} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL29} <= 0) ? 0 :  $F{TOTAL29}
) : $F{TOTAL29}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="1d726b95-f3e9-42b0-a259-8de6ea9a9b69" mode="Transparent" x="1792" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL30} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL30} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL30} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL30} <= 0) ? 0 :  $F{TOTAL30}
) : $F{TOTAL30}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="e28fdd72-43ef-494c-9d2c-5fcad30f108c" mode="Transparent" x="1845" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL31} >= 0 ||
$F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL31} <= 0 ? (
($F{FILA}.equals("TOTAL DIF FALTANTE") && $F{TOTAL31} >= 0) ? 0 :
($F{FILA}.equals("TOTAL DIF SOBRANTE") && $F{TOTAL31} <= 0) ? 0 :  $F{TOTAL31}
) : $F{TOTAL31}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="0c9c631b-74fa-4c23-853b-5c86d2d1b9d8" mode="Opaque" x="26" y="0" width="148" height="20" forecolor="#FFFFFF" backcolor="#666666">
					<printWhenExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE")]]></printWhenExpression>
				</reportElement>
				<box leftPadding="2"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[TOTAL DIF FALTANTE]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="0c9c631b-74fa-4c23-853b-5c86d2d1b9d8" mode="Opaque" x="26" y="0" width="148" height="20" forecolor="#FFFFFF" backcolor="#666666">
					<printWhenExpression><![CDATA[$F{FILA}.equals("IMPORTE INGRESADO EN BANCO")]]></printWhenExpression>
				</reportElement>
				<box leftPadding="2"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[IMPORTE INGRESADO EN BANCO]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="0c9c631b-74fa-4c23-853b-5c86d2d1b9d8" mode="Opaque" x="26" y="0" width="148" height="20" forecolor="#FFFFFF" backcolor="#666666">
					<printWhenExpression><![CDATA[$F{FILA}.equals("DIFERENCIA RETIRADAS")]]></printWhenExpression>
				</reportElement>
				<box leftPadding="2"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[DIFERENCIA RETIRADAS]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="0c9c631b-74fa-4c23-853b-5c86d2d1b9d8" mode="Opaque" x="26" y="0" width="148" height="20" forecolor="#FFFFFF" backcolor="#666666">
					<printWhenExpression><![CDATA[$F{FILA}.equals("TOTAL DIF SOBRANTE")]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<text><![CDATA[TOTAL DIF SOBRANTE]]></text>
			</staticText>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="0943fdbe-471c-479d-95f4-5147882a736b" mode="Opaque" x="1898" y="0" width="79" height="20" forecolor="#FFFFFF" backcolor="#999999"/>
				<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{TOTAL}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="0c9c631b-74fa-4c23-853b-5c86d2d1b9d8" mode="Opaque" x="0" y="0" width="26" height="20" backcolor="#999999"/>
				<textElement/>
				<text><![CDATA[]]></text>
			</staticText>
		</band>
		<band height="20">
			<printWhenExpression><![CDATA[$F{FILA}.equals("DIFERENCIA") ||
$F{FILA}.equals("TOTAL COFRES 26010800") ||
$F{FILA}.equals("APORTACION 26010800") ||
$F{FILA}.equals("ANTICIPOS DESCONTADOS 33359200") ||
$F{FILA}.equals("PAGO A PROVEEDOR 26010900") ||
$F{FILA}.equals("TOTAL DIF FALTANTE") ||
$F{FILA}.equals("DIFERENCIA RETIRADAS")]]></printWhenExpression>
			<rectangle>
				<reportElement uuid="33e9790f-f506-436a-a0f7-5092a46a3d69" x="26" y="0" width="1951" height="20" backcolor="#999999"/>
				<graphicElement>
					<pen lineWidth="0.0"/>
				</graphicElement>
			</rectangle>
			<staticText>
				<reportElement uuid="67ca62a0-9cc5-463b-bd9c-f9e27d292d9b" mode="Opaque" x="26" y="0" width="148" height="20" forecolor="#FFFFFF" backcolor="#999999">
					<printWhenExpression><![CDATA[$F{FILA}.equals("DIFERENCIA")]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="6" isBold="true"/>
				</textElement>
				<text><![CDATA[MOV. FINANCIEROS]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="c3164953-f838-4019-a860-b8279c17b41c" x="174" y="0" width="22" height="20" forecolor="#FFFFFF"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="6" isBold="true"/>
				</textElement>
				<text><![CDATA[ESP. COD]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="325299cd-e0ea-4265-8cb4-a4d378e8c8d6" x="216" y="0" width="22" height="20" forecolor="#FFFFFF"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="6" isBold="true"/>
				</textElement>
				<text><![CDATA[PT. COD]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="67ca62a0-9cc5-463b-bd9c-f9e27d292d9b" mode="Opaque" x="26" y="0" width="148" height="20" forecolor="#FFFFFF" backcolor="#999999">
					<printWhenExpression><![CDATA[$F{FILA}.equals("TOTAL DIF FALTANTE")]]></printWhenExpression>
				</reportElement>
				<box leftPadding="2"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6" isBold="true"/>
				</textElement>
				<text><![CDATA[RETIRADAS]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="67ca62a0-9cc5-463b-bd9c-f9e27d292d9b" mode="Opaque" x="26" y="0" width="148" height="20" forecolor="#FFFFFF" backcolor="#999999">
					<printWhenExpression><![CDATA[$F{FILA}.equals("DIFERENCIA RETIRADAS")]]></printWhenExpression>
				</reportElement>
				<box leftPadding="2"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6" isBold="true"/>
				</textElement>
				<text><![CDATA[IMPORTE REAL COFRES]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="f5941565-ce0f-4387-98f4-f45d70c45b41" mode="Opaque" x="0" y="0" width="26" height="20" backcolor="#999999"/>
				<textElement/>
				<text><![CDATA[]]></text>
			</staticText>
		</band>
	</detail>
	<columnFooter>
		<band height="20">
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="bfbaf65a-07b7-433e-8056-c72546811036" x="255" y="0" width="53" height="20"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL1}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="bd6c27ab-bd54-4528-b2ca-29a1638e7f45" mode="Opaque" x="26" y="0" width="148" height="20" forecolor="#FFFFFF" backcolor="#999999"/>
				<box leftPadding="3"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="6" isBold="true"/>
				</textElement>
				<text><![CDATA[TOTAL]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="07e87148-3fc6-4caf-ba52-e5bdf77bff74" mode="Opaque" x="0" y="0" width="26" height="20" backcolor="#999999"/>
				<textElement/>
				<text><![CDATA[]]></text>
			</staticText>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="6607ed55-38a9-4eef-9936-c774ac8dd151" mode="Transparent" x="308" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL2}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="cb1072f0-e7b6-43fe-b423-caa46732fa04" mode="Transparent" x="361" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL3}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="bb42f2be-4ba2-45b1-bdef-3d0677b3b4cc" mode="Transparent" x="414" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL4}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="72bf64e8-93b8-4464-8d84-8a8c7fbad73b" mode="Transparent" x="467" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL5}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="08b4274b-d3a4-4b8f-90c3-f615c6f5b0b5" mode="Transparent" x="520" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL6}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="879c87d6-dce5-4709-b208-8810a0b16377" mode="Transparent" x="573" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL7}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="4c979d04-efe6-43ca-ba29-f68a6ab605dc" mode="Transparent" x="626" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL8}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="c550b8f3-1212-4332-8cc1-b81d163c9df2" mode="Transparent" x="679" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL9}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="edefac38-b61d-42d2-bd99-8f5eee3da018" mode="Transparent" x="732" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL10}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="de187f1d-8c59-4406-8119-42d3432c1c09" mode="Transparent" x="785" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL11}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="7a61494d-40e7-4124-82ee-9e7d00faa990" mode="Transparent" x="838" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL12}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="8e676110-69cf-4666-9d7c-dab906db0ee0" mode="Transparent" x="891" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL13}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="731ab548-e439-4c21-8441-abc8882da2f5" mode="Transparent" x="944" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL14}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="7d845de0-a73f-4ef9-9b75-6203d02233b1" mode="Transparent" x="997" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL15}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="a369070f-cb84-4278-8b62-023ec87d4498" mode="Transparent" x="1050" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL16}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="163be452-08db-479d-b17f-24a3f1c4b80d" mode="Transparent" x="1103" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL17}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="c26061e0-220d-41a8-81bf-d6007b8606fe" mode="Transparent" x="1156" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL18}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="6295f613-925b-43ce-af00-8cda801b74ea" mode="Transparent" x="1209" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL19}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="86c9dbe1-c49a-425b-ba1e-174b5a83ca39" mode="Transparent" x="1262" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL20}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="c35aecea-c6f2-4b40-a08b-195c50cf5330" mode="Transparent" x="1315" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL21}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="cdcf0a73-49eb-452d-b8b7-07647b8cd495" mode="Transparent" x="1368" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL22}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="6c3d66cb-cdb5-4168-8e8c-4143d5c673a3" mode="Transparent" x="1421" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL23}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="96cd40a1-22a7-4838-a05a-dbfc5e5642b3" mode="Transparent" x="1474" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL24}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="a67aa85a-62ac-4ffe-8f2d-63a2b433ab12" mode="Transparent" x="1527" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL25}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="46412991-7dee-4de2-80cf-a8d7ac30d7e9" mode="Transparent" x="1580" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL26}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="bcb8481f-43b7-4bb9-a5dd-cb8519ed39b2" mode="Transparent" x="1633" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL27}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="edca046b-2a87-44a6-b8d0-28ab53a0322f" mode="Transparent" x="1686" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL28}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="049f8efa-4c49-446a-8411-955754f6e2a0" mode="Transparent" x="1739" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL29}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="a4476a92-ca0a-47c5-b20d-e8b264c5e0c2" mode="Transparent" x="1792" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL30}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00" isBlankWhenNull="true">
				<reportElement uuid="ad6bb385-cc30-40fe-8c51-3614150640b9" mode="Transparent" x="1845" y="0" width="53" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" markup="none">
					<font fontName="Tahoma" size="6" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SUMA_TOTAL31}]]></textFieldExpression>
			</textField>
		</band>
	</columnFooter>
</jasperReport>
