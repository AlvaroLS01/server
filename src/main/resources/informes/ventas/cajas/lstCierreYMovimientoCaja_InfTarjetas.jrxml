<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="lstCierreYMovimientoCaja_InfTarjetas" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="c20c32fa-3634-421f-8456-905bc5c07c3d">
	<property name="ireport.zoom" value="1.2100000000000006"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="SUBREPORT_DIR" class="java.lang.String">
		<defaultValueExpression><![CDATA["./"]]></defaultValueExpression>
	</parameter>
	<parameter name="FECHA_DESDE" class="java.util.Date"/>
	<parameter name="FECHA_HASTA" class="java.util.Date"/>
	<parameter name="POPERARIO" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="LOGO" class="java.io.InputStream"/>
	<parameter name="CAJERO" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="UID_ACTIVIDAD" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT DET.USUARIO,
 DET.CODMEDPAG,
 CAB.CODCAJA,
 DET.FECHA,
 DET.documento,
 (DET.CARGO - DET.ABONO) AS IMPORTE,
 CAB.CODALM,
 ALM.desalm,
 (
SELECT COUNT(1)
FROM d_caja_det_tbl DET
LEFT JOIN d_caja_cab_tbl CAB ON (CAB.uid_actividad = DET.uid_actividad AND CAB.uid_diario_caja = DET.uid_diario_caja)
WHERE
 	(DET.CODMEDPAG = '0011' OR DET.CODMEDPAG = '0010') AND ($P{CAJERO} = DET.USUARIO OR $P{CAJERO} IS NULL) AND DET.FECHA BETWEEN $P{FECHA_DESDE} AND $P{FECHA_HASTA} AND DET.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}
) AS TRANSACCION
FROM d_caja_det_tbl DET
LEFT JOIN d_caja_cab_tbl CAB ON (CAB.uid_actividad = DET.uid_actividad AND CAB.uid_diario_caja = DET.uid_diario_caja)
LEFT JOIN d_almacenes_tbl ALM ON (CAB.uid_actividad = ALM.uid_actividad AND CAB.codalm = ALM.codalm)
WHERE
	(DET.CODMEDPAG = '0011' OR DET.CODMEDPAG = '0010') AND ($P{CAJERO} = DET.USUARIO OR $P{CAJERO} IS NULL) AND DATE(DET.FECHA) BETWEEN $P{FECHA_DESDE} AND $P{FECHA_HASTA} AND DET.UID_ACTIVIDAD = $P{UID_ACTIVIDAD}
ORDER BY DET.FECHA]]>
	</queryString>
	<field name="USUARIO" class="java.lang.String"/>
	<field name="CODMEDPAG" class="java.lang.String"/>
	<field name="CODCAJA" class="java.lang.String"/>
	<field name="FECHA" class="java.sql.Timestamp"/>
	<field name="documento" class="java.lang.String"/>
	<field name="IMPORTE" class="java.math.BigDecimal"/>
	<field name="CODALM" class="java.lang.String"/>
	<field name="desalm" class="java.lang.String"/>
	<field name="TRANSACCION" class="java.lang.Long"/>
	<variable name="TOTAL_IMPORTE" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{IMPORTE}]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="151" splitType="Stretch">
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement uuid="2ab6a806-6339-47f8-91bd-e0cce75c0599" x="62" y="49" width="189" height="20"/>
				<box leftPadding="3" rightPadding="0">
					<pen lineWidth="0.25" lineColor="#CCCCCC"/>
					<topPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<leftPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<bottomPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<rightPen lineWidth="0.25" lineColor="#CCCCCC"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_DESDE}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement uuid="202c97b6-4bea-4522-8a36-46e6a98cfc6d" x="62" y="69" width="189" height="20"/>
				<box leftPadding="3" rightPadding="0">
					<pen lineWidth="0.25" lineColor="#CCCCCC"/>
					<topPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<leftPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<bottomPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<rightPen lineWidth="0.25" lineColor="#CCCCCC"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{FECHA_HASTA}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="87a74c96-de7c-45b5-943f-7a74d70509e1" mode="Opaque" x="0" y="49" width="62" height="20" forecolor="#FFFFFF" backcolor="#84999D"/>
				<box leftPadding="3">
					<pen lineWidth="0.25" lineColor="#CCCCCC"/>
					<topPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<leftPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<bottomPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<rightPen lineWidth="0.25" lineColor="#CCCCCC"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Fecha desde: ]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="87a74c96-de7c-45b5-943f-7a74d70509e1" mode="Opaque" x="0" y="69" width="62" height="20" forecolor="#FFFFFF" backcolor="#84999D"/>
				<box leftPadding="3">
					<pen lineWidth="0.25" lineColor="#CCCCCC"/>
					<topPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<leftPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<bottomPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<rightPen lineWidth="0.25" lineColor="#CCCCCC"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Fecha hasta: ]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="87a74c96-de7c-45b5-943f-7a74d70509e1" mode="Transparent" x="0" y="0" width="396" height="20" forecolor="#000000" backcolor="#81ACBB"/>
				<box leftPadding="3">
					<pen lineWidth="0.0" lineColor="#CCCCCC"/>
					<topPen lineWidth="0.0" lineColor="#CCCCCC"/>
					<leftPen lineWidth="0.0" lineColor="#CCCCCC"/>
					<bottomPen lineWidth="0.0" lineColor="#CCCCCC"/>
					<rightPen lineWidth="0.0" lineColor="#CCCCCC"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Tahoma" size="16" isBold="false"/>
				</textElement>
				<text><![CDATA[Informe de Tarjetas]]></text>
			</staticText>
			<image>
				<reportElement uuid="2863f48e-c3af-4053-a93c-eec311511a03" x="482" y="-1" width="73" height="50"/>
				<imageExpression><![CDATA[$P{LOGO}]]></imageExpression>
			</image>
			<textField pattern="dd/MM/yyyy HH:mm:ss" isBlankWhenNull="true">
				<reportElement uuid="b96fa5d5-68e2-4a46-87d5-6ec6843f04bb" x="455" y="49" width="100" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement uuid="0b638811-e926-45a1-b127-66ca9edf00ba" x="282" y="69" width="273" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{CODALM} + " - " + $F{desalm}]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<columnHeader>
		<band height="20">
			<staticText>
				<reportElement uuid="87a74c96-de7c-45b5-943f-7a74d70509e1" mode="Opaque" x="170" y="0" width="62" height="20" forecolor="#FFFFFF" backcolor="#84999D"/>
				<box>
					<pen lineWidth="0.25" lineColor="#CCCCCC"/>
					<topPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<leftPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<bottomPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<rightPen lineWidth="0.25" lineColor="#CCCCCC"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[CAJA]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="0b66783e-c9fc-41dd-8161-25d2f864e2b2" mode="Opaque" x="232" y="0" width="93" height="20" forecolor="#FFFFFF" backcolor="#84999D"/>
				<box>
					<pen lineWidth="0.25" lineColor="#CCCCCC"/>
					<topPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<leftPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<bottomPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<rightPen lineWidth="0.25" lineColor="#CCCCCC"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[FECHA Y HORA]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="83f09931-870f-459c-9e0a-a470b742501b" mode="Opaque" x="325" y="0" width="106" height="20" forecolor="#FFFFFF" backcolor="#84999D"/>
				<box>
					<pen lineWidth="0.25" lineColor="#CCCCCC"/>
					<topPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<leftPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<bottomPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<rightPen lineWidth="0.25" lineColor="#CCCCCC"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[NÂº TICKET]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="f86ba740-9167-4a67-89e0-1409a9ffa037" mode="Opaque" x="431" y="0" width="70" height="20" forecolor="#FFFFFF" backcolor="#84999D"/>
				<box>
					<pen lineWidth="0.25" lineColor="#CCCCCC"/>
					<topPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<leftPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<bottomPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<rightPen lineWidth="0.25" lineColor="#CCCCCC"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[IMPORTE]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="87a74c96-de7c-45b5-943f-7a74d70509e1" mode="Opaque" x="62" y="0" width="108" height="20" forecolor="#FFFFFF" backcolor="#84999D"/>
				<box>
					<pen lineWidth="0.25" lineColor="#CCCCCC"/>
					<topPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<leftPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<bottomPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<rightPen lineWidth="0.25" lineColor="#CCCCCC"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[OPERADOR]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="5d765bf0-0136-4c2a-94fd-259eb8af33d9" x="482" y="0" width="100" height="20"/>
				<textElement/>
				<text><![CDATA[]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="20" splitType="Stretch">
			<textField isBlankWhenNull="true">
				<reportElement uuid="4ea2ae0d-b0ab-4ca6-937d-892f6ad07b2e" x="62" y="0" width="108" height="20"/>
				<box rightPadding="3">
					<pen lineWidth="0.25" lineColor="#CCCCCC"/>
					<topPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<leftPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<bottomPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<rightPen lineWidth="0.25" lineColor="#CCCCCC"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{USUARIO}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement uuid="d4075fae-a77c-4574-9b18-121e1f015119" x="170" y="0" width="62" height="20"/>
				<box>
					<pen lineWidth="0.25" lineColor="#CCCCCC"/>
					<topPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<leftPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<bottomPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<rightPen lineWidth="0.25" lineColor="#CCCCCC"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{CODCAJA}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy HH:mm:ss" isBlankWhenNull="true">
				<reportElement uuid="84d22283-3a75-49fa-8148-b9213df6c384" x="232" y="0" width="93" height="20"/>
				<box>
					<pen lineWidth="0.25" lineColor="#CCCCCC"/>
					<topPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<leftPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<bottomPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<rightPen lineWidth="0.25" lineColor="#CCCCCC"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{FECHA}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement uuid="3c23cc7e-457c-4ca3-9da1-3e4c470e969f" x="431" y="0" width="70" height="20"/>
				<box rightPadding="3">
					<pen lineWidth="0.25" lineColor="#CCCCCC"/>
					<topPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<leftPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<bottomPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<rightPen lineWidth="0.25" lineColor="#CCCCCC"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{IMPORTE}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement uuid="49630429-3df2-4238-b309-df741aebae81" x="325" y="0" width="106" height="20"/>
				<box rightPadding="3">
					<pen lineWidth="0.25" lineColor="#CCCCCC"/>
					<topPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<leftPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<bottomPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<rightPen lineWidth="0.25" lineColor="#CCCCCC"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{documento}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<summary>
		<band height="40">
			<staticText>
				<reportElement uuid="87a74c96-de7c-45b5-943f-7a74d70509e1" mode="Opaque" x="313" y="20" width="118" height="20" forecolor="#FFFFFF" backcolor="#84999D"/>
				<box rightPadding="3">
					<pen lineWidth="0.25" lineColor="#CCCCCC"/>
					<topPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<leftPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<bottomPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<rightPen lineWidth="0.25" lineColor="#CCCCCC"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[TOTAL IMPORTE: ]]></text>
			</staticText>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement uuid="232c98f2-f6ab-4a57-ab22-7cb91156b5b4" x="431" y="20" width="70" height="20"/>
				<box rightPadding="3">
					<pen lineWidth="0.25" lineColor="#CCCCCC"/>
					<topPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<leftPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<bottomPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<rightPen lineWidth="0.25" lineColor="#CCCCCC"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Tahoma"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{TOTAL_IMPORTE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="87a74c96-de7c-45b5-943f-7a74d70509e1" mode="Opaque" x="313" y="0" width="118" height="20" forecolor="#FFFFFF" backcolor="#84999D"/>
				<box rightPadding="3">
					<pen lineWidth="0.25" lineColor="#CCCCCC"/>
					<topPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<leftPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<bottomPen lineWidth="0.25" lineColor="#CCCCCC"/>
					<rightPen lineWidth="0.25" lineColor="#CCCCCC"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Tahoma" size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[TOTAL TRANSACCIONES: ]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement uuid="f0d6df14-f16d-408e-80a5-404e6368c73b" x="431" y="0" width="70" height="20"/>
				<box rightPadding="3"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Tahoma"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{TRANSACCION}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
